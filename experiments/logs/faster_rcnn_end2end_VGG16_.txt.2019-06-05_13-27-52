+ echo Logging output to experiments/logs/faster_rcnn_end2end_VGG16_.txt.2019-06-05_13-27-52
Logging output to experiments/logs/faster_rcnn_end2end_VGG16_.txt.2019-06-05_13-27-52
+ /usr/bin/python ./tools/train_net.py --gpu 0 --solver models/pascal_voc/VGG16/faster_rcnn_end2end/solver.prototxt --weights data/imagenet_models/VGG16.v2.caffemodel --imdb voc_2012_train --iters 2000000 --cfg experiments/cfgs/faster_rcnn_end2end.yml
Called with args:
Namespace(cfg_file='experiments/cfgs/faster_rcnn_end2end.yml', gpu_id=0, imdb_name='voc_2012_train', max_iters=2000000, pretrained_model='data/imagenet_models/VGG16.v2.caffemodel', randomize=False, set_cfgs=None, solver='models/pascal_voc/VGG16/faster_rcnn_end2end/solver.prototxt')
Using config:
{'BBOX_XFORM_CLIP': 4.135166556742356,
 'DATA_DIR': '/home/fujenchu/projects/affordanceContext/affordance-net/data',
 'DEDUP_BOXES': 0.0625,
 'EPS': 1e-14,
 'EXP_DIR': 'faster_rcnn_end2end',
 'GPU_ID': 0,
 'MATLAB': 'matlab',
 'MODELS_DIR': '/home/fujenchu/projects/affordanceContext/affordance-net/models/coco',
 'PIXEL_MEANS': array([[[102.9801, 115.9465, 122.7717]]]),
 'RNG_SEED': 7,
 'ROOT_DIR': '/home/fujenchu/projects/affordanceContext/affordance-net',
 'TEST': {'BBOX_REG': True,
          'HAS_RPN': True,
          'MASK_REG': True,
          'MAX_SIZE': 1000,
          'NMS': 0.3,
          'PROPOSAL_METHOD': 'selective_search',
          'RPN_MIN_SIZE': 16,
          'RPN_NMS_THRESH': 0.7,
          'RPN_POST_NMS_TOP_N': 1000,
          'RPN_PRE_NMS_TOP_N': 6000,
          'SCALES': [600],
          'SVM': False,
          'TEST_INSTANCE': True},
 'TRAIN': {'ASPECT_GROUPING': True,
           'BATCH_SIZE': 48,
           'BBOX_INSIDE_WEIGHTS': [1.0, 1.0, 1.0, 1.0],
           'BBOX_NORMALIZE_MEANS': [0.0, 0.0, 0.0, 0.0],
           'BBOX_NORMALIZE_STDS': [0.1, 0.1, 0.2, 0.2],
           'BBOX_NORMALIZE_TARGETS': True,
           'BBOX_NORMALIZE_TARGETS_PRECOMPUTED': True,
           'BBOX_REG': True,
           'BBOX_THRESH': 0.5,
           'BG_THRESH_HI': 0.5,
           'BG_THRESH_LO': 0.0,
           'CLASS_NUM': 7,
           'FG_FRACTION': 0.25,
           'FG_THRESH': 0.5,
           'HAS_RPN': True,
           'IMS_PER_BATCH': 1,
           'KLdivergence': True,
           'MASK_REG': True,
           'MASK_SIZE': 244,
           'MAX_SIZE': 1000,
           'PROPOSAL_METHOD': 'gt',
           'RPN_BATCHSIZE': 256,
           'RPN_BBOX_INSIDE_WEIGHTS': [1.0, 1.0, 1.0, 1.0],
           'RPN_CLOBBER_POSITIVES': False,
           'RPN_FG_FRACTION': 0.5,
           'RPN_MIN_SIZE': 0,
           'RPN_NEGATIVE_OVERLAP': 0.3,
           'RPN_NMS_THRESH': 0.7,
           'RPN_POSITIVE_OVERLAP': 0.7,
           'RPN_POSITIVE_WEIGHT': -1.0,
           'RPN_POST_NMS_TOP_N': 2000,
           'RPN_PRE_NMS_TOP_N': 12000,
           'SCALES': [600],
           'SNAPSHOT_INFIX': '',
           'SNAPSHOT_ITERS': 5000,
           'TRAINING_DATA': 'VOC_2012_train',
           'USE_FLIPPED': True,
           'USE_PREFETCH': False},
 'USE_GPU_NMS': True}
Loaded dataset `voc_2012_train` for training
Set proposal method: gt
Appending horizontally-flipped training examples...
voc_2012_train gt roidb loaded from /home/fujenchu/projects/affordanceContext/affordance-net/data/cache/voc_2012_train_gt_roidb.pkl
done
Preparing training data...
done
29646 roidb entries
Output will be saved to `/home/fujenchu/projects/affordanceContext/affordance-net/output/faster_rcnn_end2end/voc_2012_train`
Filtered 0 roidb entries: 29646 -> 29646
cfg.TRAIN.BBOX_REG = True
Computing bounding-box regression targets...
bbox target means:
[[0. 0. 0. 0.]
 [0. 0. 0. 0.]]
[0. 0. 0. 0.]
bbox target stdevs:
[[0.1 0.1 0.2 0.2]
 [0.1 0.1 0.2 0.2]]
[0.1 0.1 0.2 0.2]
Normalizing targets
done
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0605 13:27:58.112540 21499 solver.cpp:48] Initializing solver from parameters: 
train_net: "models/pascal_voc/VGG16/faster_rcnn_end2end/train.prototxt"
base_lr: 0.001
display: 20
lr_policy: "step"
gamma: 0.1
momentum: 0.9
weight_decay: 0.0005
stepsize: 49370
snapshot: 0
snapshot_prefix: "vgg16_faster_rcnn"
average_loss: 100
iter_size: 2
I0605 13:27:58.112558 21499 solver.cpp:81] Creating training net from train_net file: models/pascal_voc/VGG16/faster_rcnn_end2end/train.prototxt
I0605 13:27:58.114184 21499 net.cpp:49] Initializing net from parameters: 
name: "VGG_ILSVRC_16_layers"
state {
  phase: TRAIN
}
layer {
  name: "input-data"
  type: "Python"
  top: "data"
  top: "im_info"
  top: "gt_boxes"
  top: "seg_mask_inds"
  top: "flipped"
  python_param {
    module: "roi_data_layer.layer"
    layer: "RoIDataLayer"
    param_str: "\'num_classes\': 2"
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "data"
  top: "conv1_1"
  param {
    lr_mult: 0
    decay_mult: 0
  }
  param {
    lr_mult: 0
    decay_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  param {
    lr_mult: 0
    decay_mult: 0
  }
  param {
    lr_mult: 0
    decay_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_1"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2_1"
  param {
    lr_mult: 0
    decay_mult: 0
  }
  param {
    lr_mult: 0
    decay_mult: 0
  }
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu2_1"
  type: "ReLU"
  bottom: "conv2_1"
  top: "conv2_1"
}
layer {
  name: "conv2_2"
  type: "Convolution"
  bottom: "conv2_1"
  top: "conv2_2"
  param {
    lr_mult: 0
    decay_mult: 0
  }
  param {
    lr_mult: 0
    decay_mult: 0
  }
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu2_2"
  type: "ReLU"
  bottom: "conv2_2"
  top: "conv2_2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2_2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv3_1"
  type: "Convolution"
  bottom: "pool2"
  top: "conv3_1"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3_1"
  type: "ReLU"
  bottom: "conv3_1"
  top: "conv3_1"
}
layer {
  name: "conv3_2"
  type: "Convolution"
  bottom: "conv3_1"
  top: "conv3_2"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3_2"
  type: "ReLU"
  bottom: "conv3_2"
  top: "conv3_2"
}
layer {
  name: "conv3_3"
  type: "Convolution"
  bottom: "conv3_2"
  top: "conv3_3"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3_3"
  type: "ReLU"
  bottom: "conv3_3"
  top: "conv3_3"
}
layer {
  name: "pool3"
  type: "Pooling"
  bottom: "conv3_3"
  top: "pool3"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv4_1"
  type: "Convolution"
  bottom: "pool3"
  top: "conv4_1"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu4_1"
  type: "ReLU"
  bottom: "conv4_1"
  top: "conv4_1"
}
layer {
  name: "conv4_2"
  type: "Convolution"
  bottom: "conv4_1"
  top: "conv4_2"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu4_2"
  type: "ReLU"
  bottom: "conv4_2"
  top: "conv4_2"
}
layer {
  name: "conv4_3"
  type: "Convolution"
  bottom: "conv4_2"
  top: "conv4_3"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu4_3"
  type: "ReLU"
  bottom: "conv4_3"
  top: "conv4_3"
}
layer {
  name: "pool4"
  type: "Pooling"
  bottom: "conv4_3"
  top: "pool4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv5_1"
  type: "Convolution"
  bottom: "pool4"
  top: "conv5_1"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu5_1"
  type: "ReLU"
  bottom: "conv5_1"
  top: "conv5_1"
}
layer {
  name: "conv5_2"
  type: "Convolution"
  bottom: "conv5_1"
  top: "conv5_2"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu5_2"
  type: "ReLU"
  bottom: "conv5_2"
  top: "conv5_2"
}
layer {
  name: "conv5_3"
  type: "Convolution"
  bottom: "conv5_2"
  top: "conv5_3"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu5_3"
  type: "ReLU"
  bottom: "conv5_3"
  top: "conv5_3"
}
layer {
  name: "rpn_conv/3x3"
  type: "Convolution"
  bottom: "conv5_3"
  top: "rpn/output"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "rpn_relu/3x3"
  type: "ReLU"
  bottom: "rpn/output"
  top: "rpn/output"
}
layer {
  name: "rpn_cls_score"
  type: "Convolution"
  bottom: "rpn/output"
  top: "rpn_cls_score"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 30
    pad: 0
    kernel_size: 1
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "rpn_bbox_pred"
  type: "Convolution"
  bottom: "rpn/output"
  top: "rpn_bbox_pred"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 60
    pad: 0
    kernel_size: 1
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "rpn_cls_score_reshape"
  type: "Reshape"
  bottom: "rpn_cls_score"
  top: "rpn_cls_score_reshape"
  reshape_param {
    shape {
      dim: 0
      dim: 2
      dim: -1
      dim: 0
    }
  }
}
layer {
  name: "rpn-data"
  type: "Python"
  bottom: "rpn_cls_score"
  bottom: "gt_boxes"
  bottom: "im_info"
  bottom: "data"
  top: "rpn_labels"
  top: "rpn_bbox_targets"
  top: "rpn_bbox_inside_weights"
  top: "rpn_bbox_outside_weights"
  python_param {
    module: "rpn.anchor_target_layer"
    layer: "AnchorTargetLayer"
    param_str: "\'feat_stride\': 16 \n\'scales\': !!python/tuple [2, 4, 8, 16, 32]"
  }
}
layer {
  name: "rpn_loss_cls"
  type: "SoftmaxWithLoss"
  bottom: "rpn_cls_score_reshape"
  bottom: "rpn_labels"
  top: "rpn_cls_loss"
  loss_weight: 1
  propagate_down: true
  propagate_down: false
  loss_param {
    ignore_label: -1
    normalize: true
  }
}
layer {
  name: "rpn_loss_bbox"
  type: "SmoothL1Loss"
  bottom: "rpn_bbox_pred"
  bottom: "rpn_bbox_targets"
  bottom: "rpn_bbox_inside_weights"
  bottom: "rpn_bbox_outside_weights"
  top: "rpn_loss_bbox"
  loss_weight: 1
  smooth_l1_loss_param {
    sigma: 3
  }
}
layer {
  name: "rpn_cls_prob"
  type: "Softmax"
  bottom: "rpn_cls_score_reshape"
  top: "rpn_cls_prob"
}
layer {
  name: "rpn_cls_prob_reshape"
  type: "Reshape"
  bottom: "rpn_cls_prob"
  top: "rpn_cls_prob_reshape"
  reshape_param {
    shape {
      dim: 0
      dim: 30
      dim: -1
      dim: 0
    }
  }
}
layer {
  name: "proposal"
  type: "Python"
  bottom: "rpn_cls_prob_reshape"
  bottom: "rpn_bbox_pred"
  bottom: "im_info"
  top: "rpn_rois"
  python_param {
    module: "rpn.proposal_layer"
    layer: "ProposalLayer"
    param_str: "\'feat_stride\': 16 \n\'scales\': !!python/tuple [2, 4, 8, 16, 32]"
  }
}
layer {
  name: "roi-data"
  type: "Python"
  bottom: "rpn_rois"
  bottom: "gt_boxes"
  bottom: "im_info"
  bottom: "seg_mask_inds"
  bottom: "flipped"
  top: "rois"
  top: "labels"
  top: "bbox_targets"
  top: "bbox_inside_weights"
  top: "bbox_outside_weights"
  top: "mask_targets"
  top: "rois_pos"
  top: "rois_attribute"
  python_param {
    module: "rpn.proposal_target_layer"
    layer: "ProposalTargetLayer"
    param_str: "\'num_classes\': 2"
  }
}
layer {
  name: "roi_pool5"
  type: "ROIAlignment"
  bottom: "conv5_3"
  bottom: "rois"
  top: "pool5"
  roi_alignment_param {
    pooled_h: 7
    pooled_w: 7
    spatial_scale: 0.0625
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "cls_score"
  type: "InnerProduct"
  bottom: "fc7"
  top: "cls_score"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "bbox_pred"
  type: "InnerProduct"
  bottom: "fc7"
  top: "bbox_pred"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  inner_product_param {
    num_output: 8
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "loss_cls"
  type: "SoftmaxWithLoss"
  bottom: "cls_score"
  bottom: "labels"
  top: "loss_cls"
  loss_weight: 3
  propagate_down: true
  propagate_down: false
}
layer {
  name: "loss_bbox"
  type: "SmoothL1Loss"
  bottom: "bbox_pred"
  bottom: "bbox_targets"
  bottom: "bbox_inside_weights"
  bottom: "bbox_outside_weights"
  top: "loss_bbox"
  loss_weight: 2
}
layer {
  name: "roi_pool5_2"
  type: "ROIAlignment"
  bottom: "conv5_3"
  bottom: "rois_pos"
  top: "pool5_2"
  roi_alignment_param {
    pooled_h: 7
    pooled_w: 7
    spatial_scale: 0.0625
  }
}
layer {
  name: "pool5_2_conv"
  type: "Convolution"
  bottom: "pool5_2"
  top: "pool5_2_conv"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 0
    kernel_size: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "pool5_2_conv_relu"
  type: "ReLU"
  bottom: "pool5_2_conv"
  top: "pool5_2_conv_relu"
}
layer {
  name: "pool5_2_conv2"
  type: "Convolution"
  bottom: "pool5_2_conv_relu"
  top: "pool5_2_conv2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "pool5_2_conv2_relu"
  type: "ReLU"
  bottom: "pool5_2_conv2"
  top: "pool5_2_conv2_relu"
}
layer {
  name: "mask_deconv1"
  type: "Deconvolution"
  bottom: "pool5_2_conv2_relu"
  top: "mask_deconv1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 8
    group: 256
    stride: 4
    weight_filler {
      type: "bilinear"
    }
  }
}
layer {
  name: "pool5_2_conv3"
  type: "Convolution"
  bottom: "mask_deconv1"
  top: "pool5_2_conv3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "pool5_2_conv3_relu"
  type: "ReLU"
  bottom: "pool5_2_conv3"
  top: "pool5_2_conv3_relu"
}
layer {
  name: "pool5_2_conv4"
  type: "Convolution"
  bottom: "pool5_2_conv3_relu"
  top: "pool5_2_conv4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "pool5_2_conv4_relu"
  type: "ReLU"
  bottom: "pool5_2_conv4"
  top: "pool5_2_conv4_relu"
}
layer {
  name: "query_conv"
  type: "Convolution"
  bottom: "pool5_2_conv4_relu"
  top: "query_conv"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 0
    kernel_size: 1
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "key_conv"
  type: "Convolution"
  bottom: "pool5_2_conv4_relu"
  top: "key_conv"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 0
    kernel_size: 1
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "value_conv"
  type: "Convolution"
  bottom: "pool5_2_conv4_relu"
  top: "value_conv"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 0
    kernel_size: 1
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "query_conv_reshape"
  type: "Reshape"
  bottom: "query_conv"
  top: "query_conv_reshape"
  reshape_param {
    shape {
      dim: -1
      dim: 64
      dim: 900
      dim: 1
    }
  }
}
layer {
  name: "key_conv_reshape"
  type: "Reshape"
  bottom: "key_conv"
  top: "key_conv_reshape"
  reshape_param {
    shape {
      dim: -1
      dim: 64
      dim: 900
      dim: 1
    }
  }
}
layer {
  name: "value_conv_reshape"
  type: "Reshape"
  bottom: "value_conv"
  top: "value_conv_reshape"
  reshape_param {
    shape {
      dim: -1
      dim: 512
      dim: 900
      dim: 1
    }
  }
}
layer {
  name: "query_conv_reshape_perm"
  type: "Permute"
  bottom: "query_conv_reshape"
  top: "query_conv_reshape_perm"
  permute_param {
    order: 0
    order: 3
    order: 2
    order: 1
  }
}
layer {
  name: "key_conv_reshape_perm"
  type: "Permute"
  bottom: "key_conv_reshape"
  top: "key_conv_reshape_perm"
  permute_param {
    order: 0
    order: 3
    order: 1
    order: 2
  }
}
layer {
  name: "energy"
  type: "MatrixMultiplication"
  bottom: "query_conv_reshape_perm"
  bottom: "key_conv_reshape_perm"
  top: "energy"
}
layer {
  name: "attention"
  type: "Softmax"
  bottom: "energy"
  top: "attention"
  softmax_param {
    axis: 3
  }
}
layer {
  name: "value_conv_reshape_perm"
  type: "Permute"
  bottom: "value_conv_reshape"
  top: "value_conv_reshape_perm"
  permute_param {
    order: 0
    order: 3
    order: 1
    order: 2
  }
}
layer {
  name: "attention_perm"
  type: "Permute"
  bottom: "attention"
  top: "attention_perm"
  permute_param {
    order: 0
    order: 1
    order: 2
    order: 3
  }
}
layer {
  name: "out"
  type: "MatrixMultiplication"
  bottom: "value_conv_reshape_perm"
  bottom: "attention_perm"
  top: "out"
}
layer {
  name: "out_reshape"
  type: "Reshape"
  bottom: "out"
  top: "out_reshape"
  reshape_param {
    shape {
      dim: -1
      dim: 512
      dim: 30
      dim: 30
    }
  }
}
layer {
  name: "out_reshape_scale"
  type: "Scale"
  bottom: "out_reshape"
  top: "out_reshape_scale"
  param {
    name: "scale_conv1_1"
    lr_mult: 1
  }
  scale_param {
    bias_term: false
  }
}
layer {
  name: "out_x"
  type: "Eltwise"
  bottom: "out_reshape_scale"
  bottom: "pool5_2_conv4_relu"
  top: "out_x"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "query_conv_reshape_ch"
  type: "Reshape"
  bottom: "pool5_2_conv4_relu"
  top: "query_conv_reshape_ch"
  reshape_param {
    shape {
      dim: 1
      dim: 512
      dim: -1
      dim: 1
    }
  }
}
layer {
  name: "key_conv_reshape_ch"
  type: "Reshape"
  bottom: "pool5_2_conv4_relu"
  top: "key_conv_reshape_ch"
  reshape_param {
    shape {
      dim: 1
      dim: 512
      dim: -1
      dim: 1
    }
  }
}
layer {
  name: "value_conv_reshape_ch"
  type: "Reshape"
  bottom: "pool5_2_conv4_relu"
  top: "value_conv_reshape_ch"
  reshape_param {
    shape {
      dim: 1
      dim: 512
      dim: -1
      dim: 1
    }
  }
}
layer {
  name: "query_conv_reshape_perm_ch"
  type: "Permute"
  bottom: "query_conv_reshape_ch"
  top: "query_conv_reshape_perm_ch"
  permute_param {
    order: 0
    order: 3
    order: 1
    order: 2
  }
}
layer {
  name: "key_conv_reshape_perm_ch"
  type: "Permute"
  bottom: "key_conv_reshape_ch"
  top: "key_conv_reshape_perm_ch"
  permute_param {
    order: 0
    order: 3
    order: 2
    order: 1
  }
}
layer {
  name: "energy_ch"
  type: "MatrixMultiplication"
  bottom: "query_conv_reshape_perm_ch"
  bottom: "key_conv_reshape_perm_ch"
  top: "energy_ch"
}
layer {
  name: "energy_ch_pool"
  type: "Pooling"
  bottom: "energy_ch"
  top: "energy_ch_pool"
  pooling_param {
    pool: MAX
    kernel_h: 1
    kernel_w: 512
    stride_h: 1
    stride_w: 512
  }
}
layer {
  name: "energy_ch_max"
  type: "Tile"
  bottom: "energy_ch_pool"
  top: "energy_ch_max"
  tile_param {
    axis: 3
    tiles: 512
  }
}
layer {
  name: "energy_ch_minus"
  type: "Power"
  bottom: "energy_ch"
  top: "energy_ch_minus"
  power_param {
    power: 1
    scale: -1
    shift: 0
  }
}
layer {
  name: "energy_new"
  type: "Eltwise"
  bottom: "energy_ch_max"
  bottom: "energy_ch_minus"
  top: "energy_new"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "attention_ch"
  type: "Softmax"
  bottom: "energy_new"
  top: "attention_ch"
  softmax_param {
    axis: 3
  }
}
layer {
  name: "value_conv_reshape_ch_perm"
  type: "Permute"
  bottom: "value_conv_reshape_ch"
  top: "value_conv_reshape_ch_perm"
  permute_param {
    order: 0
    order: 3
    order: 1
    order: 2
  }
}
layer {
  name: "attention_ch_perm"
  type: "Permute"
  bottom: "attention_ch"
  top: "attention_ch_perm"
  permute_param {
    order: 0
    order: 1
    order: 2
    order: 3
  }
}
layer {
  name: "out_ch"
  type: "MatrixMultiplication"
  bottom: "attention_ch_perm"
  bottom: "value_conv_reshape_ch_perm"
  top: "out_ch"
}
layer {
  name: "out_ch_reshape"
  type: "Reshape"
  bottom: "out_ch"
  top: "out_ch_reshape"
  reshape_param {
    shape {
      dim: -1
      dim: 512
      dim: 30
      dim: 30
    }
  }
}
layer {
  name: "out_ch_reshape_scale"
  type: "Scale"
  bottom: "out_ch_reshape"
  top: "out_ch_reshape_scale"
  param {
    name: "scale_conv1_1"
    lr_mult: 1
  }
  scale_param {
    bias_term: false
  }
}
layer {
  name: "out_ch_x"
  type: "Eltwise"
  bottom: "out_ch_reshape_scale"
  bottom: "pool5_2_conv4_relu"
  top: "out_ch_x"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "out_conv_ch_x"
  type: "Convolution"
  bottom: "out_ch_x"
  top: "out_conv_ch_x"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 0
    kernel_size: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "out_conv_x"
  type: "Convolution"
  bottom: "out_x"
  top: "out_conv_x"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 0
    kernel_size: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "out_x_sum"
  type: "Eltwise"
  bottom: "out_conv_x"
  bottom: "out_conv_ch_x"
  top: "out_x_sum"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "mask_deconv2"
  type: "Deconvolution"
  bottom: "out_x_sum"
  top: "mask_deconv2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 8
    group: 256
    stride: 4
    weight_filler {
      type: "bilinear"
    }
  }
}
layer {
  name: "pool5_2_conv5"
  type: "Convolution"
  bottom: "mask_deconv2"
  top: "pool5_2_conv5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "pool5_2_conv5_relu"
  type: "ReLU"
  bottom: "pool5_2_conv5"
  top: "pool5_2_conv5_relu"
}
layer {
  name: "pool5_2_conv6"
  type: "Convolution"
  bottom: "pool5_2_conv5_relu"
  top: "pool5_2_conv6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "pool5_2_conv6_relu"
  type: "ReLU"
  bottom: "pool5_2_conv6"
  top: "pool5_2_conv6_relu"
}
layer {
  name: "mask_deconv3"
  type: "Deconvolution"
  bottom: "pool5_2_conv6_relu"
  top: "mask_deconv3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 4
    group: 256
    stride: 2
    weight_filler {
      type: "bilinear"
    }
  }
}
layer {
  name: "mask_score"
  type: "Convolution"
  bottom: "mask_deconv3"
  top: "mask_score"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 8
    pad: 0
    kernel_size: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "loss_mask"
  type: "SoftmaxWithLoss"
  bottom: "mask_score"
  bottom: "mask_targets"
  top: "loss_mask"
  loss_weight: 3
  propagate_down: true
  propagate_down: false
  loss_param {
    ignore_label: -1
    normalize: true
  }
}
I0605 13:27:58.114516 21499 layer_factory.hpp:77] Creating layer input-data
I0605 13:27:58.155071 21499 net.cpp:106] Creating Layer input-data
I0605 13:27:58.155088 21499 net.cpp:411] input-data -> data
I0605 13:27:58.155097 21499 net.cpp:411] input-data -> im_info
I0605 13:27:58.155100 21499 net.cpp:411] input-data -> gt_boxes
I0605 13:27:58.155105 21499 net.cpp:411] input-data -> seg_mask_inds
I0605 13:27:58.155108 21499 net.cpp:411] input-data -> flipped
RoiDataLayer: name_to_top: {'gt_boxes': 2, 'data': 0, 'seg_mask_inds': 3, 'im_info': 1, 'flipped': 4}
I0605 13:27:58.180374 21499 net.cpp:150] Setting up input-data
I0605 13:27:58.180392 21499 net.cpp:157] Top shape: 1 3 600 1000 (1800000)
I0605 13:27:58.180397 21499 net.cpp:157] Top shape: 1 3 (3)
I0605 13:27:58.180399 21499 net.cpp:157] Top shape: 1 4 (4)
I0605 13:27:58.180402 21499 net.cpp:157] Top shape: 1 2 (2)
I0605 13:27:58.180404 21499 net.cpp:157] Top shape: 1 1 (1)
I0605 13:27:58.180408 21499 net.cpp:165] Memory required for data: 7200040
I0605 13:27:58.180413 21499 layer_factory.hpp:77] Creating layer data_input-data_0_split
I0605 13:27:58.180425 21499 net.cpp:106] Creating Layer data_input-data_0_split
I0605 13:27:58.180429 21499 net.cpp:454] data_input-data_0_split <- data
I0605 13:27:58.180434 21499 net.cpp:411] data_input-data_0_split -> data_input-data_0_split_0
I0605 13:27:58.180441 21499 net.cpp:411] data_input-data_0_split -> data_input-data_0_split_1
I0605 13:27:58.180464 21499 net.cpp:150] Setting up data_input-data_0_split
I0605 13:27:58.180469 21499 net.cpp:157] Top shape: 1 3 600 1000 (1800000)
I0605 13:27:58.180471 21499 net.cpp:157] Top shape: 1 3 600 1000 (1800000)
I0605 13:27:58.180474 21499 net.cpp:165] Memory required for data: 21600040
I0605 13:27:58.180476 21499 layer_factory.hpp:77] Creating layer im_info_input-data_1_split
I0605 13:27:58.180481 21499 net.cpp:106] Creating Layer im_info_input-data_1_split
I0605 13:27:58.180485 21499 net.cpp:454] im_info_input-data_1_split <- im_info
I0605 13:27:58.180487 21499 net.cpp:411] im_info_input-data_1_split -> im_info_input-data_1_split_0
I0605 13:27:58.180491 21499 net.cpp:411] im_info_input-data_1_split -> im_info_input-data_1_split_1
I0605 13:27:58.180496 21499 net.cpp:411] im_info_input-data_1_split -> im_info_input-data_1_split_2
I0605 13:27:58.180521 21499 net.cpp:150] Setting up im_info_input-data_1_split
I0605 13:27:58.180526 21499 net.cpp:157] Top shape: 1 3 (3)
I0605 13:27:58.180528 21499 net.cpp:157] Top shape: 1 3 (3)
I0605 13:27:58.180531 21499 net.cpp:157] Top shape: 1 3 (3)
I0605 13:27:58.180533 21499 net.cpp:165] Memory required for data: 21600076
I0605 13:27:58.180536 21499 layer_factory.hpp:77] Creating layer gt_boxes_input-data_2_split
I0605 13:27:58.180539 21499 net.cpp:106] Creating Layer gt_boxes_input-data_2_split
I0605 13:27:58.180541 21499 net.cpp:454] gt_boxes_input-data_2_split <- gt_boxes
I0605 13:27:58.180544 21499 net.cpp:411] gt_boxes_input-data_2_split -> gt_boxes_input-data_2_split_0
I0605 13:27:58.180548 21499 net.cpp:411] gt_boxes_input-data_2_split -> gt_boxes_input-data_2_split_1
I0605 13:27:58.180564 21499 net.cpp:150] Setting up gt_boxes_input-data_2_split
I0605 13:27:58.180569 21499 net.cpp:157] Top shape: 1 4 (4)
I0605 13:27:58.180572 21499 net.cpp:157] Top shape: 1 4 (4)
I0605 13:27:58.180573 21499 net.cpp:165] Memory required for data: 21600108
I0605 13:27:58.180577 21499 layer_factory.hpp:77] Creating layer conv1_1
I0605 13:27:58.180585 21499 net.cpp:106] Creating Layer conv1_1
I0605 13:27:58.180589 21499 net.cpp:454] conv1_1 <- data_input-data_0_split_0
I0605 13:27:58.180593 21499 net.cpp:411] conv1_1 -> conv1_1
I0605 13:27:58.376816 21499 net.cpp:150] Setting up conv1_1
I0605 13:27:58.376837 21499 net.cpp:157] Top shape: 1 64 600 1000 (38400000)
I0605 13:27:58.376839 21499 net.cpp:165] Memory required for data: 175200108
I0605 13:27:58.376849 21499 layer_factory.hpp:77] Creating layer relu1_1
I0605 13:27:58.376858 21499 net.cpp:106] Creating Layer relu1_1
I0605 13:27:58.376873 21499 net.cpp:454] relu1_1 <- conv1_1
I0605 13:27:58.376876 21499 net.cpp:397] relu1_1 -> conv1_1 (in-place)
I0605 13:27:58.377010 21499 net.cpp:150] Setting up relu1_1
I0605 13:27:58.377017 21499 net.cpp:157] Top shape: 1 64 600 1000 (38400000)
I0605 13:27:58.377029 21499 net.cpp:165] Memory required for data: 328800108
I0605 13:27:58.377032 21499 layer_factory.hpp:77] Creating layer conv1_2
I0605 13:27:58.377049 21499 net.cpp:106] Creating Layer conv1_2
I0605 13:27:58.377051 21499 net.cpp:454] conv1_2 <- conv1_1
I0605 13:27:58.377054 21499 net.cpp:411] conv1_2 -> conv1_2
I0605 13:27:58.379144 21499 net.cpp:150] Setting up conv1_2
I0605 13:27:58.379155 21499 net.cpp:157] Top shape: 1 64 600 1000 (38400000)
I0605 13:27:58.379158 21499 net.cpp:165] Memory required for data: 482400108
I0605 13:27:58.379165 21499 layer_factory.hpp:77] Creating layer relu1_2
I0605 13:27:58.379170 21499 net.cpp:106] Creating Layer relu1_2
I0605 13:27:58.379173 21499 net.cpp:454] relu1_2 <- conv1_2
I0605 13:27:58.379178 21499 net.cpp:397] relu1_2 -> conv1_2 (in-place)
I0605 13:27:58.379297 21499 net.cpp:150] Setting up relu1_2
I0605 13:27:58.379302 21499 net.cpp:157] Top shape: 1 64 600 1000 (38400000)
I0605 13:27:58.379305 21499 net.cpp:165] Memory required for data: 636000108
I0605 13:27:58.379307 21499 layer_factory.hpp:77] Creating layer pool1
I0605 13:27:58.379313 21499 net.cpp:106] Creating Layer pool1
I0605 13:27:58.379317 21499 net.cpp:454] pool1 <- conv1_2
I0605 13:27:58.379320 21499 net.cpp:411] pool1 -> pool1
I0605 13:27:58.379369 21499 net.cpp:150] Setting up pool1
I0605 13:27:58.379374 21499 net.cpp:157] Top shape: 1 64 300 500 (9600000)
I0605 13:27:58.379386 21499 net.cpp:165] Memory required for data: 674400108
I0605 13:27:58.379389 21499 layer_factory.hpp:77] Creating layer conv2_1
I0605 13:27:58.379395 21499 net.cpp:106] Creating Layer conv2_1
I0605 13:27:58.379396 21499 net.cpp:454] conv2_1 <- pool1
I0605 13:27:58.379400 21499 net.cpp:411] conv2_1 -> conv2_1
I0605 13:27:58.381086 21499 net.cpp:150] Setting up conv2_1
I0605 13:27:58.381095 21499 net.cpp:157] Top shape: 1 128 300 500 (19200000)
I0605 13:27:58.381098 21499 net.cpp:165] Memory required for data: 751200108
I0605 13:27:58.381105 21499 layer_factory.hpp:77] Creating layer relu2_1
I0605 13:27:58.381109 21499 net.cpp:106] Creating Layer relu2_1
I0605 13:27:58.381112 21499 net.cpp:454] relu2_1 <- conv2_1
I0605 13:27:58.381115 21499 net.cpp:397] relu2_1 -> conv2_1 (in-place)
I0605 13:27:58.381623 21499 net.cpp:150] Setting up relu2_1
I0605 13:27:58.381630 21499 net.cpp:157] Top shape: 1 128 300 500 (19200000)
I0605 13:27:58.381633 21499 net.cpp:165] Memory required for data: 828000108
I0605 13:27:58.381635 21499 layer_factory.hpp:77] Creating layer conv2_2
I0605 13:27:58.381641 21499 net.cpp:106] Creating Layer conv2_2
I0605 13:27:58.381644 21499 net.cpp:454] conv2_2 <- conv2_1
I0605 13:27:58.381647 21499 net.cpp:411] conv2_2 -> conv2_2
I0605 13:27:58.383101 21499 net.cpp:150] Setting up conv2_2
I0605 13:27:58.383123 21499 net.cpp:157] Top shape: 1 128 300 500 (19200000)
I0605 13:27:58.383126 21499 net.cpp:165] Memory required for data: 904800108
I0605 13:27:58.383131 21499 layer_factory.hpp:77] Creating layer relu2_2
I0605 13:27:58.383136 21499 net.cpp:106] Creating Layer relu2_2
I0605 13:27:58.383150 21499 net.cpp:454] relu2_2 <- conv2_2
I0605 13:27:58.383154 21499 net.cpp:397] relu2_2 -> conv2_2 (in-place)
I0605 13:27:58.383288 21499 net.cpp:150] Setting up relu2_2
I0605 13:27:58.383294 21499 net.cpp:157] Top shape: 1 128 300 500 (19200000)
I0605 13:27:58.383306 21499 net.cpp:165] Memory required for data: 981600108
I0605 13:27:58.383308 21499 layer_factory.hpp:77] Creating layer pool2
I0605 13:27:58.383312 21499 net.cpp:106] Creating Layer pool2
I0605 13:27:58.383314 21499 net.cpp:454] pool2 <- conv2_2
I0605 13:27:58.383330 21499 net.cpp:411] pool2 -> pool2
I0605 13:27:58.383368 21499 net.cpp:150] Setting up pool2
I0605 13:27:58.383373 21499 net.cpp:157] Top shape: 1 128 150 250 (4800000)
I0605 13:27:58.383374 21499 net.cpp:165] Memory required for data: 1000800108
I0605 13:27:58.383386 21499 layer_factory.hpp:77] Creating layer conv3_1
I0605 13:27:58.383391 21499 net.cpp:106] Creating Layer conv3_1
I0605 13:27:58.383395 21499 net.cpp:454] conv3_1 <- pool2
I0605 13:27:58.383401 21499 net.cpp:411] conv3_1 -> conv3_1
I0605 13:27:58.385300 21499 net.cpp:150] Setting up conv3_1
I0605 13:27:58.385311 21499 net.cpp:157] Top shape: 1 256 150 250 (9600000)
I0605 13:27:58.385314 21499 net.cpp:165] Memory required for data: 1039200108
I0605 13:27:58.385321 21499 layer_factory.hpp:77] Creating layer relu3_1
I0605 13:27:58.385327 21499 net.cpp:106] Creating Layer relu3_1
I0605 13:27:58.385330 21499 net.cpp:454] relu3_1 <- conv3_1
I0605 13:27:58.385334 21499 net.cpp:397] relu3_1 -> conv3_1 (in-place)
I0605 13:27:58.385509 21499 net.cpp:150] Setting up relu3_1
I0605 13:27:58.385514 21499 net.cpp:157] Top shape: 1 256 150 250 (9600000)
I0605 13:27:58.385516 21499 net.cpp:165] Memory required for data: 1077600108
I0605 13:27:58.385519 21499 layer_factory.hpp:77] Creating layer conv3_2
I0605 13:27:58.385527 21499 net.cpp:106] Creating Layer conv3_2
I0605 13:27:58.385529 21499 net.cpp:454] conv3_2 <- conv3_1
I0605 13:27:58.385534 21499 net.cpp:411] conv3_2 -> conv3_2
I0605 13:27:58.387488 21499 net.cpp:150] Setting up conv3_2
I0605 13:27:58.387497 21499 net.cpp:157] Top shape: 1 256 150 250 (9600000)
I0605 13:27:58.387501 21499 net.cpp:165] Memory required for data: 1116000108
I0605 13:27:58.387506 21499 layer_factory.hpp:77] Creating layer relu3_2
I0605 13:27:58.387509 21499 net.cpp:106] Creating Layer relu3_2
I0605 13:27:58.387512 21499 net.cpp:454] relu3_2 <- conv3_2
I0605 13:27:58.387516 21499 net.cpp:397] relu3_2 -> conv3_2 (in-place)
I0605 13:27:58.387647 21499 net.cpp:150] Setting up relu3_2
I0605 13:27:58.387653 21499 net.cpp:157] Top shape: 1 256 150 250 (9600000)
I0605 13:27:58.387655 21499 net.cpp:165] Memory required for data: 1154400108
I0605 13:27:58.387657 21499 layer_factory.hpp:77] Creating layer conv3_3
I0605 13:27:58.387663 21499 net.cpp:106] Creating Layer conv3_3
I0605 13:27:58.387665 21499 net.cpp:454] conv3_3 <- conv3_2
I0605 13:27:58.387670 21499 net.cpp:411] conv3_3 -> conv3_3
I0605 13:27:58.389693 21499 net.cpp:150] Setting up conv3_3
I0605 13:27:58.389703 21499 net.cpp:157] Top shape: 1 256 150 250 (9600000)
I0605 13:27:58.389705 21499 net.cpp:165] Memory required for data: 1192800108
I0605 13:27:58.389711 21499 layer_factory.hpp:77] Creating layer relu3_3
I0605 13:27:58.389715 21499 net.cpp:106] Creating Layer relu3_3
I0605 13:27:58.389719 21499 net.cpp:454] relu3_3 <- conv3_3
I0605 13:27:58.389721 21499 net.cpp:397] relu3_3 -> conv3_3 (in-place)
I0605 13:27:58.389850 21499 net.cpp:150] Setting up relu3_3
I0605 13:27:58.389856 21499 net.cpp:157] Top shape: 1 256 150 250 (9600000)
I0605 13:27:58.389858 21499 net.cpp:165] Memory required for data: 1231200108
I0605 13:27:58.389861 21499 layer_factory.hpp:77] Creating layer pool3
I0605 13:27:58.389865 21499 net.cpp:106] Creating Layer pool3
I0605 13:27:58.389868 21499 net.cpp:454] pool3 <- conv3_3
I0605 13:27:58.389873 21499 net.cpp:411] pool3 -> pool3
I0605 13:27:58.389919 21499 net.cpp:150] Setting up pool3
I0605 13:27:58.389925 21499 net.cpp:157] Top shape: 1 256 75 125 (2400000)
I0605 13:27:58.389938 21499 net.cpp:165] Memory required for data: 1240800108
I0605 13:27:58.389940 21499 layer_factory.hpp:77] Creating layer conv4_1
I0605 13:27:58.389945 21499 net.cpp:106] Creating Layer conv4_1
I0605 13:27:58.389947 21499 net.cpp:454] conv4_1 <- pool3
I0605 13:27:58.389952 21499 net.cpp:411] conv4_1 -> conv4_1
I0605 13:27:58.393690 21499 net.cpp:150] Setting up conv4_1
I0605 13:27:58.393708 21499 net.cpp:157] Top shape: 1 512 75 125 (4800000)
I0605 13:27:58.393712 21499 net.cpp:165] Memory required for data: 1260000108
I0605 13:27:58.393718 21499 layer_factory.hpp:77] Creating layer relu4_1
I0605 13:27:58.393726 21499 net.cpp:106] Creating Layer relu4_1
I0605 13:27:58.393730 21499 net.cpp:454] relu4_1 <- conv4_1
I0605 13:27:58.393734 21499 net.cpp:397] relu4_1 -> conv4_1 (in-place)
I0605 13:27:58.393872 21499 net.cpp:150] Setting up relu4_1
I0605 13:27:58.393877 21499 net.cpp:157] Top shape: 1 512 75 125 (4800000)
I0605 13:27:58.393879 21499 net.cpp:165] Memory required for data: 1279200108
I0605 13:27:58.393882 21499 layer_factory.hpp:77] Creating layer conv4_2
I0605 13:27:58.393888 21499 net.cpp:106] Creating Layer conv4_2
I0605 13:27:58.393891 21499 net.cpp:454] conv4_2 <- conv4_1
I0605 13:27:58.393894 21499 net.cpp:411] conv4_2 -> conv4_2
I0605 13:27:58.398742 21499 net.cpp:150] Setting up conv4_2
I0605 13:27:58.398761 21499 net.cpp:157] Top shape: 1 512 75 125 (4800000)
I0605 13:27:58.398766 21499 net.cpp:165] Memory required for data: 1298400108
I0605 13:27:58.398775 21499 layer_factory.hpp:77] Creating layer relu4_2
I0605 13:27:58.398792 21499 net.cpp:106] Creating Layer relu4_2
I0605 13:27:58.398797 21499 net.cpp:454] relu4_2 <- conv4_2
I0605 13:27:58.398802 21499 net.cpp:397] relu4_2 -> conv4_2 (in-place)
I0605 13:27:58.399343 21499 net.cpp:150] Setting up relu4_2
I0605 13:27:58.399351 21499 net.cpp:157] Top shape: 1 512 75 125 (4800000)
I0605 13:27:58.399353 21499 net.cpp:165] Memory required for data: 1317600108
I0605 13:27:58.399356 21499 layer_factory.hpp:77] Creating layer conv4_3
I0605 13:27:58.399374 21499 net.cpp:106] Creating Layer conv4_3
I0605 13:27:58.399379 21499 net.cpp:454] conv4_3 <- conv4_2
I0605 13:27:58.399384 21499 net.cpp:411] conv4_3 -> conv4_3
I0605 13:27:58.404162 21499 net.cpp:150] Setting up conv4_3
I0605 13:27:58.404181 21499 net.cpp:157] Top shape: 1 512 75 125 (4800000)
I0605 13:27:58.404183 21499 net.cpp:165] Memory required for data: 1336800108
I0605 13:27:58.404191 21499 layer_factory.hpp:77] Creating layer relu4_3
I0605 13:27:58.404208 21499 net.cpp:106] Creating Layer relu4_3
I0605 13:27:58.404213 21499 net.cpp:454] relu4_3 <- conv4_3
I0605 13:27:58.404218 21499 net.cpp:397] relu4_3 -> conv4_3 (in-place)
I0605 13:27:58.404337 21499 net.cpp:150] Setting up relu4_3
I0605 13:27:58.404343 21499 net.cpp:157] Top shape: 1 512 75 125 (4800000)
I0605 13:27:58.404345 21499 net.cpp:165] Memory required for data: 1356000108
I0605 13:27:58.404347 21499 layer_factory.hpp:77] Creating layer pool4
I0605 13:27:58.404366 21499 net.cpp:106] Creating Layer pool4
I0605 13:27:58.404369 21499 net.cpp:454] pool4 <- conv4_3
I0605 13:27:58.404376 21499 net.cpp:411] pool4 -> pool4
I0605 13:27:58.404405 21499 net.cpp:150] Setting up pool4
I0605 13:27:58.404409 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.404422 21499 net.cpp:165] Memory required for data: 1360903020
I0605 13:27:58.404424 21499 layer_factory.hpp:77] Creating layer conv5_1
I0605 13:27:58.404441 21499 net.cpp:106] Creating Layer conv5_1
I0605 13:27:58.404445 21499 net.cpp:454] conv5_1 <- pool4
I0605 13:27:58.404449 21499 net.cpp:411] conv5_1 -> conv5_1
I0605 13:27:58.409024 21499 net.cpp:150] Setting up conv5_1
I0605 13:27:58.409040 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.409044 21499 net.cpp:165] Memory required for data: 1365805932
I0605 13:27:58.409049 21499 layer_factory.hpp:77] Creating layer relu5_1
I0605 13:27:58.409059 21499 net.cpp:106] Creating Layer relu5_1
I0605 13:27:58.409061 21499 net.cpp:454] relu5_1 <- conv5_1
I0605 13:27:58.409076 21499 net.cpp:397] relu5_1 -> conv5_1 (in-place)
I0605 13:27:58.409198 21499 net.cpp:150] Setting up relu5_1
I0605 13:27:58.409204 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.409206 21499 net.cpp:165] Memory required for data: 1370708844
I0605 13:27:58.409209 21499 layer_factory.hpp:77] Creating layer conv5_2
I0605 13:27:58.409216 21499 net.cpp:106] Creating Layer conv5_2
I0605 13:27:58.409219 21499 net.cpp:454] conv5_2 <- conv5_1
I0605 13:27:58.409222 21499 net.cpp:411] conv5_2 -> conv5_2
I0605 13:27:58.413506 21499 net.cpp:150] Setting up conv5_2
I0605 13:27:58.413524 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.413527 21499 net.cpp:165] Memory required for data: 1375611756
I0605 13:27:58.413533 21499 layer_factory.hpp:77] Creating layer relu5_2
I0605 13:27:58.413542 21499 net.cpp:106] Creating Layer relu5_2
I0605 13:27:58.413545 21499 net.cpp:454] relu5_2 <- conv5_2
I0605 13:27:58.413549 21499 net.cpp:397] relu5_2 -> conv5_2 (in-place)
I0605 13:27:58.413682 21499 net.cpp:150] Setting up relu5_2
I0605 13:27:58.413688 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.413691 21499 net.cpp:165] Memory required for data: 1380514668
I0605 13:27:58.413693 21499 layer_factory.hpp:77] Creating layer conv5_3
I0605 13:27:58.413702 21499 net.cpp:106] Creating Layer conv5_3
I0605 13:27:58.413705 21499 net.cpp:454] conv5_3 <- conv5_2
I0605 13:27:58.413709 21499 net.cpp:411] conv5_3 -> conv5_3
I0605 13:27:58.418188 21499 net.cpp:150] Setting up conv5_3
I0605 13:27:58.418217 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.418221 21499 net.cpp:165] Memory required for data: 1385417580
I0605 13:27:58.418239 21499 layer_factory.hpp:77] Creating layer relu5_3
I0605 13:27:58.418249 21499 net.cpp:106] Creating Layer relu5_3
I0605 13:27:58.418254 21499 net.cpp:454] relu5_3 <- conv5_3
I0605 13:27:58.418260 21499 net.cpp:397] relu5_3 -> conv5_3 (in-place)
I0605 13:27:58.418423 21499 net.cpp:150] Setting up relu5_3
I0605 13:27:58.418431 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.418432 21499 net.cpp:165] Memory required for data: 1390320492
I0605 13:27:58.418435 21499 layer_factory.hpp:77] Creating layer conv5_3_relu5_3_0_split
I0605 13:27:58.418439 21499 net.cpp:106] Creating Layer conv5_3_relu5_3_0_split
I0605 13:27:58.418442 21499 net.cpp:454] conv5_3_relu5_3_0_split <- conv5_3
I0605 13:27:58.418447 21499 net.cpp:411] conv5_3_relu5_3_0_split -> conv5_3_relu5_3_0_split_0
I0605 13:27:58.418462 21499 net.cpp:411] conv5_3_relu5_3_0_split -> conv5_3_relu5_3_0_split_1
I0605 13:27:58.418467 21499 net.cpp:411] conv5_3_relu5_3_0_split -> conv5_3_relu5_3_0_split_2
I0605 13:27:58.418514 21499 net.cpp:150] Setting up conv5_3_relu5_3_0_split
I0605 13:27:58.418519 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.418521 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.418524 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.418525 21499 net.cpp:165] Memory required for data: 1405029228
I0605 13:27:58.418527 21499 layer_factory.hpp:77] Creating layer rpn_conv/3x3
I0605 13:27:58.418535 21499 net.cpp:106] Creating Layer rpn_conv/3x3
I0605 13:27:58.418548 21499 net.cpp:454] rpn_conv/3x3 <- conv5_3_relu5_3_0_split_0
I0605 13:27:58.418553 21499 net.cpp:411] rpn_conv/3x3 -> rpn/output
I0605 13:27:58.469116 21499 net.cpp:150] Setting up rpn_conv/3x3
I0605 13:27:58.469146 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.469149 21499 net.cpp:165] Memory required for data: 1409932140
I0605 13:27:58.469156 21499 layer_factory.hpp:77] Creating layer rpn_relu/3x3
I0605 13:27:58.469175 21499 net.cpp:106] Creating Layer rpn_relu/3x3
I0605 13:27:58.469180 21499 net.cpp:454] rpn_relu/3x3 <- rpn/output
I0605 13:27:58.469187 21499 net.cpp:397] rpn_relu/3x3 -> rpn/output (in-place)
I0605 13:27:58.469326 21499 net.cpp:150] Setting up rpn_relu/3x3
I0605 13:27:58.469332 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.469344 21499 net.cpp:165] Memory required for data: 1414835052
I0605 13:27:58.469347 21499 layer_factory.hpp:77] Creating layer rpn/output_rpn_relu/3x3_0_split
I0605 13:27:58.469362 21499 net.cpp:106] Creating Layer rpn/output_rpn_relu/3x3_0_split
I0605 13:27:58.469365 21499 net.cpp:454] rpn/output_rpn_relu/3x3_0_split <- rpn/output
I0605 13:27:58.469369 21499 net.cpp:411] rpn/output_rpn_relu/3x3_0_split -> rpn/output_rpn_relu/3x3_0_split_0
I0605 13:27:58.469375 21499 net.cpp:411] rpn/output_rpn_relu/3x3_0_split -> rpn/output_rpn_relu/3x3_0_split_1
I0605 13:27:58.469408 21499 net.cpp:150] Setting up rpn/output_rpn_relu/3x3_0_split
I0605 13:27:58.469430 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.469435 21499 net.cpp:157] Top shape: 1 512 38 63 (1225728)
I0605 13:27:58.469437 21499 net.cpp:165] Memory required for data: 1424640876
I0605 13:27:58.469439 21499 layer_factory.hpp:77] Creating layer rpn_cls_score
I0605 13:27:58.469449 21499 net.cpp:106] Creating Layer rpn_cls_score
I0605 13:27:58.469451 21499 net.cpp:454] rpn_cls_score <- rpn/output_rpn_relu/3x3_0_split_0
I0605 13:27:58.469456 21499 net.cpp:411] rpn_cls_score -> rpn_cls_score
I0605 13:27:58.471123 21499 net.cpp:150] Setting up rpn_cls_score
I0605 13:27:58.471132 21499 net.cpp:157] Top shape: 1 30 38 63 (71820)
I0605 13:27:58.471139 21499 net.cpp:165] Memory required for data: 1424928156
I0605 13:27:58.471144 21499 layer_factory.hpp:77] Creating layer rpn_cls_score_rpn_cls_score_0_split
I0605 13:27:58.471150 21499 net.cpp:106] Creating Layer rpn_cls_score_rpn_cls_score_0_split
I0605 13:27:58.471155 21499 net.cpp:454] rpn_cls_score_rpn_cls_score_0_split <- rpn_cls_score
I0605 13:27:58.471160 21499 net.cpp:411] rpn_cls_score_rpn_cls_score_0_split -> rpn_cls_score_rpn_cls_score_0_split_0
I0605 13:27:58.471168 21499 net.cpp:411] rpn_cls_score_rpn_cls_score_0_split -> rpn_cls_score_rpn_cls_score_0_split_1
I0605 13:27:58.471197 21499 net.cpp:150] Setting up rpn_cls_score_rpn_cls_score_0_split
I0605 13:27:58.471201 21499 net.cpp:157] Top shape: 1 30 38 63 (71820)
I0605 13:27:58.471204 21499 net.cpp:157] Top shape: 1 30 38 63 (71820)
I0605 13:27:58.471210 21499 net.cpp:165] Memory required for data: 1425502716
I0605 13:27:58.471211 21499 layer_factory.hpp:77] Creating layer rpn_bbox_pred
I0605 13:27:58.471223 21499 net.cpp:106] Creating Layer rpn_bbox_pred
I0605 13:27:58.471226 21499 net.cpp:454] rpn_bbox_pred <- rpn/output_rpn_relu/3x3_0_split_1
I0605 13:27:58.471232 21499 net.cpp:411] rpn_bbox_pred -> rpn_bbox_pred
I0605 13:27:58.472771 21499 net.cpp:150] Setting up rpn_bbox_pred
I0605 13:27:58.472780 21499 net.cpp:157] Top shape: 1 60 38 63 (143640)
I0605 13:27:58.472782 21499 net.cpp:165] Memory required for data: 1426077276
I0605 13:27:58.472787 21499 layer_factory.hpp:77] Creating layer rpn_bbox_pred_rpn_bbox_pred_0_split
I0605 13:27:58.472793 21499 net.cpp:106] Creating Layer rpn_bbox_pred_rpn_bbox_pred_0_split
I0605 13:27:58.472798 21499 net.cpp:454] rpn_bbox_pred_rpn_bbox_pred_0_split <- rpn_bbox_pred
I0605 13:27:58.472803 21499 net.cpp:411] rpn_bbox_pred_rpn_bbox_pred_0_split -> rpn_bbox_pred_rpn_bbox_pred_0_split_0
I0605 13:27:58.472810 21499 net.cpp:411] rpn_bbox_pred_rpn_bbox_pred_0_split -> rpn_bbox_pred_rpn_bbox_pred_0_split_1
I0605 13:27:58.472838 21499 net.cpp:150] Setting up rpn_bbox_pred_rpn_bbox_pred_0_split
I0605 13:27:58.472843 21499 net.cpp:157] Top shape: 1 60 38 63 (143640)
I0605 13:27:58.472847 21499 net.cpp:157] Top shape: 1 60 38 63 (143640)
I0605 13:27:58.472849 21499 net.cpp:165] Memory required for data: 1427226396
I0605 13:27:58.472853 21499 layer_factory.hpp:77] Creating layer rpn_cls_score_reshape
I0605 13:27:58.472860 21499 net.cpp:106] Creating Layer rpn_cls_score_reshape
I0605 13:27:58.472864 21499 net.cpp:454] rpn_cls_score_reshape <- rpn_cls_score_rpn_cls_score_0_split_0
I0605 13:27:58.472867 21499 net.cpp:411] rpn_cls_score_reshape -> rpn_cls_score_reshape
I0605 13:27:58.472887 21499 net.cpp:150] Setting up rpn_cls_score_reshape
I0605 13:27:58.472892 21499 net.cpp:157] Top shape: 1 2 570 63 (71820)
I0605 13:27:58.472894 21499 net.cpp:165] Memory required for data: 1427513676
I0605 13:27:58.472899 21499 layer_factory.hpp:77] Creating layer rpn_cls_score_reshape_rpn_cls_score_reshape_0_split
I0605 13:27:58.472903 21499 net.cpp:106] Creating Layer rpn_cls_score_reshape_rpn_cls_score_reshape_0_split
I0605 13:27:58.472908 21499 net.cpp:454] rpn_cls_score_reshape_rpn_cls_score_reshape_0_split <- rpn_cls_score_reshape
I0605 13:27:58.472911 21499 net.cpp:411] rpn_cls_score_reshape_rpn_cls_score_reshape_0_split -> rpn_cls_score_reshape_rpn_cls_score_reshape_0_split_0
I0605 13:27:58.472916 21499 net.cpp:411] rpn_cls_score_reshape_rpn_cls_score_reshape_0_split -> rpn_cls_score_reshape_rpn_cls_score_reshape_0_split_1
I0605 13:27:58.472939 21499 net.cpp:150] Setting up rpn_cls_score_reshape_rpn_cls_score_reshape_0_split
I0605 13:27:58.472944 21499 net.cpp:157] Top shape: 1 2 570 63 (71820)
I0605 13:27:58.472945 21499 net.cpp:157] Top shape: 1 2 570 63 (71820)
I0605 13:27:58.472949 21499 net.cpp:165] Memory required for data: 1428088236
I0605 13:27:58.472952 21499 layer_factory.hpp:77] Creating layer rpn-data
I0605 13:27:58.473309 21499 net.cpp:106] Creating Layer rpn-data
I0605 13:27:58.473317 21499 net.cpp:454] rpn-data <- rpn_cls_score_rpn_cls_score_0_split_1
I0605 13:27:58.473322 21499 net.cpp:454] rpn-data <- gt_boxes_input-data_2_split_0
I0605 13:27:58.473327 21499 net.cpp:454] rpn-data <- im_info_input-data_1_split_0
I0605 13:27:58.473331 21499 net.cpp:454] rpn-data <- data_input-data_0_split_1
I0605 13:27:58.473336 21499 net.cpp:411] rpn-data -> rpn_labels
I0605 13:27:58.473343 21499 net.cpp:411] rpn-data -> rpn_bbox_targets
I0605 13:27:58.473351 21499 net.cpp:411] rpn-data -> rpn_bbox_inside_weights
I0605 13:27:58.473356 21499 net.cpp:411] rpn-data -> rpn_bbox_outside_weights
===================================anchor_scales in AnchorTargetLayer:=============(2, 4, 8, 16, 32)
I0605 13:27:58.474251 21499 net.cpp:150] Setting up rpn-data
I0605 13:27:58.474259 21499 net.cpp:157] Top shape: 1 1 570 63 (35910)
I0605 13:27:58.474264 21499 net.cpp:157] Top shape: 1 60 38 63 (143640)
I0605 13:27:58.474267 21499 net.cpp:157] Top shape: 1 60 38 63 (143640)
I0605 13:27:58.474272 21499 net.cpp:157] Top shape: 1 60 38 63 (143640)
I0605 13:27:58.474273 21499 net.cpp:165] Memory required for data: 1429955556
I0605 13:27:58.474277 21499 layer_factory.hpp:77] Creating layer rpn_loss_cls
I0605 13:27:58.474284 21499 net.cpp:106] Creating Layer rpn_loss_cls
I0605 13:27:58.474289 21499 net.cpp:454] rpn_loss_cls <- rpn_cls_score_reshape_rpn_cls_score_reshape_0_split_0
I0605 13:27:58.474293 21499 net.cpp:454] rpn_loss_cls <- rpn_labels
I0605 13:27:58.474298 21499 net.cpp:411] rpn_loss_cls -> rpn_cls_loss
I0605 13:27:58.474309 21499 layer_factory.hpp:77] Creating layer rpn_loss_cls
I0605 13:27:58.474931 21499 net.cpp:150] Setting up rpn_loss_cls
I0605 13:27:58.474939 21499 net.cpp:157] Top shape: (1)
I0605 13:27:58.474944 21499 net.cpp:160]     with loss weight 1
I0605 13:27:58.474952 21499 net.cpp:165] Memory required for data: 1429955560
I0605 13:27:58.474956 21499 layer_factory.hpp:77] Creating layer rpn_loss_bbox
I0605 13:27:58.474967 21499 net.cpp:106] Creating Layer rpn_loss_bbox
I0605 13:27:58.474970 21499 net.cpp:454] rpn_loss_bbox <- rpn_bbox_pred_rpn_bbox_pred_0_split_0
I0605 13:27:58.474974 21499 net.cpp:454] rpn_loss_bbox <- rpn_bbox_targets
I0605 13:27:58.474979 21499 net.cpp:454] rpn_loss_bbox <- rpn_bbox_inside_weights
I0605 13:27:58.474982 21499 net.cpp:454] rpn_loss_bbox <- rpn_bbox_outside_weights
I0605 13:27:58.474988 21499 net.cpp:411] rpn_loss_bbox -> rpn_loss_bbox
I0605 13:27:58.476109 21499 net.cpp:150] Setting up rpn_loss_bbox
I0605 13:27:58.476119 21499 net.cpp:157] Top shape: (1)
I0605 13:27:58.476120 21499 net.cpp:160]     with loss weight 1
I0605 13:27:58.476127 21499 net.cpp:165] Memory required for data: 1429955564
I0605 13:27:58.476130 21499 layer_factory.hpp:77] Creating layer rpn_cls_prob
I0605 13:27:58.476135 21499 net.cpp:106] Creating Layer rpn_cls_prob
I0605 13:27:58.476140 21499 net.cpp:454] rpn_cls_prob <- rpn_cls_score_reshape_rpn_cls_score_reshape_0_split_1
I0605 13:27:58.476145 21499 net.cpp:411] rpn_cls_prob -> rpn_cls_prob
I0605 13:27:58.476307 21499 net.cpp:150] Setting up rpn_cls_prob
I0605 13:27:58.476313 21499 net.cpp:157] Top shape: 1 2 570 63 (71820)
I0605 13:27:58.476317 21499 net.cpp:165] Memory required for data: 1430242844
I0605 13:27:58.476320 21499 layer_factory.hpp:77] Creating layer rpn_cls_prob_reshape
I0605 13:27:58.476327 21499 net.cpp:106] Creating Layer rpn_cls_prob_reshape
I0605 13:27:58.476332 21499 net.cpp:454] rpn_cls_prob_reshape <- rpn_cls_prob
I0605 13:27:58.476336 21499 net.cpp:411] rpn_cls_prob_reshape -> rpn_cls_prob_reshape
I0605 13:27:58.476357 21499 net.cpp:150] Setting up rpn_cls_prob_reshape
I0605 13:27:58.476361 21499 net.cpp:157] Top shape: 1 30 38 63 (71820)
I0605 13:27:58.476364 21499 net.cpp:165] Memory required for data: 1430530124
I0605 13:27:58.476368 21499 layer_factory.hpp:77] Creating layer proposal
I0605 13:27:58.477246 21499 net.cpp:106] Creating Layer proposal
I0605 13:27:58.477254 21499 net.cpp:454] proposal <- rpn_cls_prob_reshape
I0605 13:27:58.477259 21499 net.cpp:454] proposal <- rpn_bbox_pred_rpn_bbox_pred_0_split_1
I0605 13:27:58.477264 21499 net.cpp:454] proposal <- im_info_input-data_1_split_1
I0605 13:27:58.477268 21499 net.cpp:411] proposal -> rpn_rois
=================================anchor_scales in ProposalLayer:=============(2, 4, 8, 16, 32)
I0605 13:27:58.478292 21499 net.cpp:150] Setting up proposal
I0605 13:27:58.478301 21499 net.cpp:157] Top shape: 1 5 (5)
I0605 13:27:58.478303 21499 net.cpp:165] Memory required for data: 1430530144
I0605 13:27:58.478307 21499 layer_factory.hpp:77] Creating layer roi-data
I0605 13:27:58.480640 21499 net.cpp:106] Creating Layer roi-data
I0605 13:27:58.480648 21499 net.cpp:454] roi-data <- rpn_rois
I0605 13:27:58.480662 21499 net.cpp:454] roi-data <- gt_boxes_input-data_2_split_1
I0605 13:27:58.480665 21499 net.cpp:454] roi-data <- im_info_input-data_1_split_2
I0605 13:27:58.480669 21499 net.cpp:454] roi-data <- seg_mask_inds
I0605 13:27:58.480680 21499 net.cpp:454] roi-data <- flipped
I0605 13:27:58.480685 21499 net.cpp:411] roi-data -> rois
I0605 13:27:58.480692 21499 net.cpp:411] roi-data -> labels
I0605 13:27:58.480696 21499 net.cpp:411] roi-data -> bbox_targets
I0605 13:27:58.480700 21499 net.cpp:411] roi-data -> bbox_inside_weights
I0605 13:27:58.480706 21499 net.cpp:411] roi-data -> bbox_outside_weights
I0605 13:27:58.480711 21499 net.cpp:411] roi-data -> mask_targets
I0605 13:27:58.480716 21499 net.cpp:411] roi-data -> rois_pos
I0605 13:27:58.480720 21499 net.cpp:411] roi-data -> rois_attribute
I0605 13:27:58.481005 21499 net.cpp:150] Setting up roi-data
I0605 13:27:58.481014 21499 net.cpp:157] Top shape: 1 5 (5)
I0605 13:27:58.481026 21499 net.cpp:157] Top shape: 1 1 (1)
I0605 13:27:58.481029 21499 net.cpp:157] Top shape: 1 8 (8)
I0605 13:27:58.481031 21499 net.cpp:157] Top shape: 1 8 (8)
I0605 13:27:58.481034 21499 net.cpp:157] Top shape: 1 8 (8)
I0605 13:27:58.481037 21499 net.cpp:157] Top shape: 1 244 244 (59536)
I0605 13:27:58.481041 21499 net.cpp:157] Top shape: 1 5 (5)
I0605 13:27:58.481045 21499 net.cpp:157] Top shape: 1 20 (20)
I0605 13:27:58.481047 21499 net.cpp:165] Memory required for data: 1430768508
I0605 13:27:58.481050 21499 layer_factory.hpp:77] Creating layer roi_pool5
I0605 13:27:58.481057 21499 net.cpp:106] Creating Layer roi_pool5
I0605 13:27:58.481062 21499 net.cpp:454] roi_pool5 <- conv5_3_relu5_3_0_split_1
I0605 13:27:58.481067 21499 net.cpp:454] roi_pool5 <- rois
I0605 13:27:58.481071 21499 net.cpp:411] roi_pool5 -> pool5
I0605 13:27:58.481077 21499 roi_alignment_layer.cpp:32] Spatial scale: 0.0625
I0605 13:27:58.481142 21499 net.cpp:150] Setting up roi_pool5
I0605 13:27:58.481146 21499 net.cpp:157] Top shape: 1 512 7 7 (25088)
I0605 13:27:58.481148 21499 net.cpp:165] Memory required for data: 1430868860
I0605 13:27:58.481153 21499 layer_factory.hpp:77] Creating layer fc6
I0605 13:27:58.481159 21499 net.cpp:106] Creating Layer fc6
I0605 13:27:58.481163 21499 net.cpp:454] fc6 <- pool5
I0605 13:27:58.481166 21499 net.cpp:411] fc6 -> fc6
I0605 13:27:58.622712 21499 net.cpp:150] Setting up fc6
I0605 13:27:58.622745 21499 net.cpp:157] Top shape: 1 4096 (4096)
I0605 13:27:58.622748 21499 net.cpp:165] Memory required for data: 1430885244
I0605 13:27:58.622761 21499 layer_factory.hpp:77] Creating layer relu6
I0605 13:27:58.622781 21499 net.cpp:106] Creating Layer relu6
I0605 13:27:58.622784 21499 net.cpp:454] relu6 <- fc6
I0605 13:27:58.622788 21499 net.cpp:397] relu6 -> fc6 (in-place)
I0605 13:27:58.622977 21499 net.cpp:150] Setting up relu6
I0605 13:27:58.622983 21499 net.cpp:157] Top shape: 1 4096 (4096)
I0605 13:27:58.622995 21499 net.cpp:165] Memory required for data: 1430901628
I0605 13:27:58.622998 21499 layer_factory.hpp:77] Creating layer fc7
I0605 13:27:58.623003 21499 net.cpp:106] Creating Layer fc7
I0605 13:27:58.623006 21499 net.cpp:454] fc7 <- fc6
I0605 13:27:58.623009 21499 net.cpp:411] fc7 -> fc7
I0605 13:27:58.646325 21499 net.cpp:150] Setting up fc7
I0605 13:27:58.646359 21499 net.cpp:157] Top shape: 1 4096 (4096)
I0605 13:27:58.646363 21499 net.cpp:165] Memory required for data: 1430918012
I0605 13:27:58.646370 21499 layer_factory.hpp:77] Creating layer relu7
I0605 13:27:58.646378 21499 net.cpp:106] Creating Layer relu7
I0605 13:27:58.646392 21499 net.cpp:454] relu7 <- fc7
I0605 13:27:58.646397 21499 net.cpp:397] relu7 -> fc7 (in-place)
I0605 13:27:58.646576 21499 net.cpp:150] Setting up relu7
I0605 13:27:58.646581 21499 net.cpp:157] Top shape: 1 4096 (4096)
I0605 13:27:58.646595 21499 net.cpp:165] Memory required for data: 1430934396
I0605 13:27:58.646597 21499 layer_factory.hpp:77] Creating layer fc7_relu7_0_split
I0605 13:27:58.646601 21499 net.cpp:106] Creating Layer fc7_relu7_0_split
I0605 13:27:58.646605 21499 net.cpp:454] fc7_relu7_0_split <- fc7
I0605 13:27:58.646617 21499 net.cpp:411] fc7_relu7_0_split -> fc7_relu7_0_split_0
I0605 13:27:58.646628 21499 net.cpp:411] fc7_relu7_0_split -> fc7_relu7_0_split_1
I0605 13:27:58.646665 21499 net.cpp:150] Setting up fc7_relu7_0_split
I0605 13:27:58.646670 21499 net.cpp:157] Top shape: 1 4096 (4096)
I0605 13:27:58.646687 21499 net.cpp:157] Top shape: 1 4096 (4096)
I0605 13:27:58.646688 21499 net.cpp:165] Memory required for data: 1430967164
I0605 13:27:58.646690 21499 layer_factory.hpp:77] Creating layer cls_score
I0605 13:27:58.646705 21499 net.cpp:106] Creating Layer cls_score
I0605 13:27:58.646708 21499 net.cpp:454] cls_score <- fc7_relu7_0_split_0
I0605 13:27:58.646711 21499 net.cpp:411] cls_score -> cls_score
I0605 13:27:58.646967 21499 net.cpp:150] Setting up cls_score
I0605 13:27:58.646972 21499 net.cpp:157] Top shape: 1 2 (2)
I0605 13:27:58.646984 21499 net.cpp:165] Memory required for data: 1430967172
I0605 13:27:58.646988 21499 layer_factory.hpp:77] Creating layer bbox_pred
I0605 13:27:58.646992 21499 net.cpp:106] Creating Layer bbox_pred
I0605 13:27:58.646994 21499 net.cpp:454] bbox_pred <- fc7_relu7_0_split_1
I0605 13:27:58.647008 21499 net.cpp:411] bbox_pred -> bbox_pred
I0605 13:27:58.647752 21499 net.cpp:150] Setting up bbox_pred
I0605 13:27:58.647758 21499 net.cpp:157] Top shape: 1 8 (8)
I0605 13:27:58.647769 21499 net.cpp:165] Memory required for data: 1430967204
I0605 13:27:58.647773 21499 layer_factory.hpp:77] Creating layer loss_cls
I0605 13:27:58.647778 21499 net.cpp:106] Creating Layer loss_cls
I0605 13:27:58.647780 21499 net.cpp:454] loss_cls <- cls_score
I0605 13:27:58.647783 21499 net.cpp:454] loss_cls <- labels
I0605 13:27:58.647788 21499 net.cpp:411] loss_cls -> loss_cls
I0605 13:27:58.647794 21499 layer_factory.hpp:77] Creating layer loss_cls
I0605 13:27:58.648514 21499 net.cpp:150] Setting up loss_cls
I0605 13:27:58.648521 21499 net.cpp:157] Top shape: (1)
I0605 13:27:58.648525 21499 net.cpp:160]     with loss weight 3
I0605 13:27:58.648546 21499 net.cpp:165] Memory required for data: 1430967208
I0605 13:27:58.648551 21499 layer_factory.hpp:77] Creating layer loss_bbox
I0605 13:27:58.648557 21499 net.cpp:106] Creating Layer loss_bbox
I0605 13:27:58.648564 21499 net.cpp:454] loss_bbox <- bbox_pred
I0605 13:27:58.648569 21499 net.cpp:454] loss_bbox <- bbox_targets
I0605 13:27:58.648574 21499 net.cpp:454] loss_bbox <- bbox_inside_weights
I0605 13:27:58.648579 21499 net.cpp:454] loss_bbox <- bbox_outside_weights
I0605 13:27:58.648584 21499 net.cpp:411] loss_bbox -> loss_bbox
I0605 13:27:58.648644 21499 net.cpp:150] Setting up loss_bbox
I0605 13:27:58.648650 21499 net.cpp:157] Top shape: (1)
I0605 13:27:58.648654 21499 net.cpp:160]     with loss weight 2
I0605 13:27:58.648659 21499 net.cpp:165] Memory required for data: 1430967212
I0605 13:27:58.648663 21499 layer_factory.hpp:77] Creating layer roi_pool5_2
I0605 13:27:58.648681 21499 net.cpp:106] Creating Layer roi_pool5_2
I0605 13:27:58.648687 21499 net.cpp:454] roi_pool5_2 <- conv5_3_relu5_3_0_split_2
I0605 13:27:58.648702 21499 net.cpp:454] roi_pool5_2 <- rois_pos
I0605 13:27:58.648707 21499 net.cpp:411] roi_pool5_2 -> pool5_2
I0605 13:27:58.648715 21499 roi_alignment_layer.cpp:32] Spatial scale: 0.0625
I0605 13:27:58.648784 21499 net.cpp:150] Setting up roi_pool5_2
I0605 13:27:58.648792 21499 net.cpp:157] Top shape: 1 512 7 7 (25088)
I0605 13:27:58.648794 21499 net.cpp:165] Memory required for data: 1431067564
I0605 13:27:58.648798 21499 layer_factory.hpp:77] Creating layer pool5_2_conv
I0605 13:27:58.648818 21499 net.cpp:106] Creating Layer pool5_2_conv
I0605 13:27:58.648823 21499 net.cpp:454] pool5_2_conv <- pool5_2
I0605 13:27:58.648841 21499 net.cpp:411] pool5_2_conv -> pool5_2_conv
I0605 13:27:58.655478 21499 net.cpp:150] Setting up pool5_2_conv
I0605 13:27:58.655488 21499 net.cpp:157] Top shape: 1 512 7 7 (25088)
I0605 13:27:58.655491 21499 net.cpp:165] Memory required for data: 1431167916
I0605 13:27:58.655508 21499 layer_factory.hpp:77] Creating layer pool5_2_conv_relu
I0605 13:27:58.655526 21499 net.cpp:106] Creating Layer pool5_2_conv_relu
I0605 13:27:58.655531 21499 net.cpp:454] pool5_2_conv_relu <- pool5_2_conv
I0605 13:27:58.655540 21499 net.cpp:411] pool5_2_conv_relu -> pool5_2_conv_relu
I0605 13:27:58.655695 21499 net.cpp:150] Setting up pool5_2_conv_relu
I0605 13:27:58.655702 21499 net.cpp:157] Top shape: 1 512 7 7 (25088)
I0605 13:27:58.655705 21499 net.cpp:165] Memory required for data: 1431268268
I0605 13:27:58.655709 21499 layer_factory.hpp:77] Creating layer pool5_2_conv2
I0605 13:27:58.655735 21499 net.cpp:106] Creating Layer pool5_2_conv2
I0605 13:27:58.655740 21499 net.cpp:454] pool5_2_conv2 <- pool5_2_conv_relu
I0605 13:27:58.655747 21499 net.cpp:411] pool5_2_conv2 -> pool5_2_conv2
I0605 13:27:58.706308 21499 net.cpp:150] Setting up pool5_2_conv2
I0605 13:27:58.706326 21499 net.cpp:157] Top shape: 1 512 7 7 (25088)
I0605 13:27:58.706331 21499 net.cpp:165] Memory required for data: 1431368620
I0605 13:27:58.706339 21499 layer_factory.hpp:77] Creating layer pool5_2_conv2_relu
I0605 13:27:58.706351 21499 net.cpp:106] Creating Layer pool5_2_conv2_relu
I0605 13:27:58.706367 21499 net.cpp:454] pool5_2_conv2_relu <- pool5_2_conv2
I0605 13:27:58.706372 21499 net.cpp:411] pool5_2_conv2_relu -> pool5_2_conv2_relu
I0605 13:27:58.706519 21499 net.cpp:150] Setting up pool5_2_conv2_relu
I0605 13:27:58.706527 21499 net.cpp:157] Top shape: 1 512 7 7 (25088)
I0605 13:27:58.706531 21499 net.cpp:165] Memory required for data: 1431468972
I0605 13:27:58.706534 21499 layer_factory.hpp:77] Creating layer mask_deconv1
I0605 13:27:58.706542 21499 net.cpp:106] Creating Layer mask_deconv1
I0605 13:27:58.706547 21499 net.cpp:454] mask_deconv1 <- pool5_2_conv2_relu
I0605 13:27:58.706554 21499 net.cpp:411] mask_deconv1 -> mask_deconv1
I0605 13:27:58.707316 21499 net.cpp:150] Setting up mask_deconv1
I0605 13:27:58.707324 21499 net.cpp:157] Top shape: 1 256 30 30 (230400)
I0605 13:27:58.707326 21499 net.cpp:165] Memory required for data: 1432390572
I0605 13:27:58.707334 21499 layer_factory.hpp:77] Creating layer pool5_2_conv3
I0605 13:27:58.707343 21499 net.cpp:106] Creating Layer pool5_2_conv3
I0605 13:27:58.707360 21499 net.cpp:454] pool5_2_conv3 <- mask_deconv1
I0605 13:27:58.707367 21499 net.cpp:411] pool5_2_conv3 -> pool5_2_conv3
I0605 13:27:58.732859 21499 net.cpp:150] Setting up pool5_2_conv3
I0605 13:27:58.732879 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.732883 21499 net.cpp:165] Memory required for data: 1434233772
I0605 13:27:58.732892 21499 layer_factory.hpp:77] Creating layer pool5_2_conv3_relu
I0605 13:27:58.732901 21499 net.cpp:106] Creating Layer pool5_2_conv3_relu
I0605 13:27:58.732918 21499 net.cpp:454] pool5_2_conv3_relu <- pool5_2_conv3
I0605 13:27:58.732925 21499 net.cpp:411] pool5_2_conv3_relu -> pool5_2_conv3_relu
I0605 13:27:58.733073 21499 net.cpp:150] Setting up pool5_2_conv3_relu
I0605 13:27:58.733080 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.733083 21499 net.cpp:165] Memory required for data: 1436076972
I0605 13:27:58.733088 21499 layer_factory.hpp:77] Creating layer pool5_2_conv4
I0605 13:27:58.733099 21499 net.cpp:106] Creating Layer pool5_2_conv4
I0605 13:27:58.733104 21499 net.cpp:454] pool5_2_conv4 <- pool5_2_conv3_relu
I0605 13:27:58.733122 21499 net.cpp:411] pool5_2_conv4 -> pool5_2_conv4
I0605 13:27:58.783200 21499 net.cpp:150] Setting up pool5_2_conv4
I0605 13:27:58.783218 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783221 21499 net.cpp:165] Memory required for data: 1437920172
I0605 13:27:58.783231 21499 layer_factory.hpp:77] Creating layer pool5_2_conv4_relu
I0605 13:27:58.783241 21499 net.cpp:106] Creating Layer pool5_2_conv4_relu
I0605 13:27:58.783258 21499 net.cpp:454] pool5_2_conv4_relu <- pool5_2_conv4
I0605 13:27:58.783274 21499 net.cpp:411] pool5_2_conv4_relu -> pool5_2_conv4_relu
I0605 13:27:58.783445 21499 net.cpp:150] Setting up pool5_2_conv4_relu
I0605 13:27:58.783452 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783457 21499 net.cpp:165] Memory required for data: 1439763372
I0605 13:27:58.783459 21499 layer_factory.hpp:77] Creating layer pool5_2_conv4_relu_pool5_2_conv4_relu_0_split
I0605 13:27:58.783468 21499 net.cpp:106] Creating Layer pool5_2_conv4_relu_pool5_2_conv4_relu_0_split
I0605 13:27:58.783473 21499 net.cpp:454] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split <- pool5_2_conv4_relu
I0605 13:27:58.783491 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_0
I0605 13:27:58.783499 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_1
I0605 13:27:58.783507 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_2
I0605 13:27:58.783514 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_3
I0605 13:27:58.783520 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_4
I0605 13:27:58.783535 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_5
I0605 13:27:58.783551 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_6
I0605 13:27:58.783558 21499 net.cpp:411] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split -> pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_7
I0605 13:27:58.783661 21499 net.cpp:150] Setting up pool5_2_conv4_relu_pool5_2_conv4_relu_0_split
I0605 13:27:58.783668 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783671 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783676 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783680 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783684 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783690 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783704 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783708 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.783713 21499 net.cpp:165] Memory required for data: 1454508972
I0605 13:27:58.783717 21499 layer_factory.hpp:77] Creating layer query_conv
I0605 13:27:58.783730 21499 net.cpp:106] Creating Layer query_conv
I0605 13:27:58.783735 21499 net.cpp:454] query_conv <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_0
I0605 13:27:58.783743 21499 net.cpp:411] query_conv -> query_conv
I0605 13:27:58.785267 21499 net.cpp:150] Setting up query_conv
I0605 13:27:58.785275 21499 net.cpp:157] Top shape: 1 64 30 30 (57600)
I0605 13:27:58.785279 21499 net.cpp:165] Memory required for data: 1454739372
I0605 13:27:58.785285 21499 layer_factory.hpp:77] Creating layer key_conv
I0605 13:27:58.785310 21499 net.cpp:106] Creating Layer key_conv
I0605 13:27:58.785315 21499 net.cpp:454] key_conv <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_1
I0605 13:27:58.785324 21499 net.cpp:411] key_conv -> key_conv
I0605 13:27:58.786988 21499 net.cpp:150] Setting up key_conv
I0605 13:27:58.786996 21499 net.cpp:157] Top shape: 1 64 30 30 (57600)
I0605 13:27:58.787000 21499 net.cpp:165] Memory required for data: 1454969772
I0605 13:27:58.787006 21499 layer_factory.hpp:77] Creating layer value_conv
I0605 13:27:58.787019 21499 net.cpp:106] Creating Layer value_conv
I0605 13:27:58.787037 21499 net.cpp:454] value_conv <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_2
I0605 13:27:58.787045 21499 net.cpp:411] value_conv -> value_conv
I0605 13:27:58.793838 21499 net.cpp:150] Setting up value_conv
I0605 13:27:58.793851 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.793855 21499 net.cpp:165] Memory required for data: 1456812972
I0605 13:27:58.793862 21499 layer_factory.hpp:77] Creating layer query_conv_reshape
I0605 13:27:58.793874 21499 net.cpp:106] Creating Layer query_conv_reshape
I0605 13:27:58.793890 21499 net.cpp:454] query_conv_reshape <- query_conv
I0605 13:27:58.793906 21499 net.cpp:411] query_conv_reshape -> query_conv_reshape
I0605 13:27:58.793953 21499 net.cpp:150] Setting up query_conv_reshape
I0605 13:27:58.793959 21499 net.cpp:157] Top shape: 1 64 900 1 (57600)
I0605 13:27:58.793962 21499 net.cpp:165] Memory required for data: 1457043372
I0605 13:27:58.793965 21499 layer_factory.hpp:77] Creating layer key_conv_reshape
I0605 13:27:58.793973 21499 net.cpp:106] Creating Layer key_conv_reshape
I0605 13:27:58.793978 21499 net.cpp:454] key_conv_reshape <- key_conv
I0605 13:27:58.793984 21499 net.cpp:411] key_conv_reshape -> key_conv_reshape
I0605 13:27:58.794019 21499 net.cpp:150] Setting up key_conv_reshape
I0605 13:27:58.794034 21499 net.cpp:157] Top shape: 1 64 900 1 (57600)
I0605 13:27:58.794037 21499 net.cpp:165] Memory required for data: 1457273772
I0605 13:27:58.794050 21499 layer_factory.hpp:77] Creating layer value_conv_reshape
I0605 13:27:58.794057 21499 net.cpp:106] Creating Layer value_conv_reshape
I0605 13:27:58.794064 21499 net.cpp:454] value_conv_reshape <- value_conv
I0605 13:27:58.794070 21499 net.cpp:411] value_conv_reshape -> value_conv_reshape
I0605 13:27:58.794100 21499 net.cpp:150] Setting up value_conv_reshape
I0605 13:27:58.794106 21499 net.cpp:157] Top shape: 1 512 900 1 (460800)
I0605 13:27:58.794108 21499 net.cpp:165] Memory required for data: 1459116972
I0605 13:27:58.794111 21499 layer_factory.hpp:77] Creating layer query_conv_reshape_perm
I0605 13:27:58.794126 21499 net.cpp:106] Creating Layer query_conv_reshape_perm
I0605 13:27:58.794131 21499 net.cpp:454] query_conv_reshape_perm <- query_conv_reshape
I0605 13:27:58.794136 21499 net.cpp:411] query_conv_reshape_perm -> query_conv_reshape_perm
I0605 13:27:58.794204 21499 net.cpp:150] Setting up query_conv_reshape_perm
I0605 13:27:58.794209 21499 net.cpp:157] Top shape: 1 1 900 64 (57600)
I0605 13:27:58.794214 21499 net.cpp:165] Memory required for data: 1459347372
I0605 13:27:58.794217 21499 layer_factory.hpp:77] Creating layer key_conv_reshape_perm
I0605 13:27:58.794224 21499 net.cpp:106] Creating Layer key_conv_reshape_perm
I0605 13:27:58.794229 21499 net.cpp:454] key_conv_reshape_perm <- key_conv_reshape
I0605 13:27:58.794234 21499 net.cpp:411] key_conv_reshape_perm -> key_conv_reshape_perm
I0605 13:27:58.794322 21499 net.cpp:150] Setting up key_conv_reshape_perm
I0605 13:27:58.794328 21499 net.cpp:157] Top shape: 1 1 64 900 (57600)
I0605 13:27:58.794332 21499 net.cpp:165] Memory required for data: 1459577772
I0605 13:27:58.794344 21499 layer_factory.hpp:77] Creating layer energy
I0605 13:27:58.794353 21499 net.cpp:106] Creating Layer energy
I0605 13:27:58.794358 21499 net.cpp:454] energy <- query_conv_reshape_perm
I0605 13:27:58.794364 21499 net.cpp:454] energy <- key_conv_reshape_perm
I0605 13:27:58.794373 21499 net.cpp:411] energy -> energy
I0605 13:27:58.794394 21499 net.cpp:150] Setting up energy
I0605 13:27:58.794399 21499 net.cpp:157] Top shape: 1 1 900 900 (810000)
I0605 13:27:58.794404 21499 net.cpp:165] Memory required for data: 1462817772
I0605 13:27:58.794406 21499 layer_factory.hpp:77] Creating layer attention
I0605 13:27:58.794414 21499 net.cpp:106] Creating Layer attention
I0605 13:27:58.794418 21499 net.cpp:454] attention <- energy
I0605 13:27:58.794425 21499 net.cpp:411] attention -> attention
I0605 13:27:58.794589 21499 net.cpp:150] Setting up attention
I0605 13:27:58.794596 21499 net.cpp:157] Top shape: 1 1 900 900 (810000)
I0605 13:27:58.794600 21499 net.cpp:165] Memory required for data: 1466057772
I0605 13:27:58.794603 21499 layer_factory.hpp:77] Creating layer value_conv_reshape_perm
I0605 13:27:58.794610 21499 net.cpp:106] Creating Layer value_conv_reshape_perm
I0605 13:27:58.794615 21499 net.cpp:454] value_conv_reshape_perm <- value_conv_reshape
I0605 13:27:58.794621 21499 net.cpp:411] value_conv_reshape_perm -> value_conv_reshape_perm
I0605 13:27:58.794695 21499 net.cpp:150] Setting up value_conv_reshape_perm
I0605 13:27:58.794701 21499 net.cpp:157] Top shape: 1 1 512 900 (460800)
I0605 13:27:58.794705 21499 net.cpp:165] Memory required for data: 1467900972
I0605 13:27:58.794710 21499 layer_factory.hpp:77] Creating layer attention_perm
I0605 13:27:58.794718 21499 net.cpp:106] Creating Layer attention_perm
I0605 13:27:58.794723 21499 net.cpp:454] attention_perm <- attention
I0605 13:27:58.794729 21499 net.cpp:411] attention_perm -> attention_perm
I0605 13:27:58.794796 21499 net.cpp:150] Setting up attention_perm
I0605 13:27:58.794802 21499 net.cpp:157] Top shape: 1 1 900 900 (810000)
I0605 13:27:58.794806 21499 net.cpp:165] Memory required for data: 1471140972
I0605 13:27:58.794809 21499 layer_factory.hpp:77] Creating layer out
I0605 13:27:58.794814 21499 net.cpp:106] Creating Layer out
I0605 13:27:58.794821 21499 net.cpp:454] out <- value_conv_reshape_perm
I0605 13:27:58.794826 21499 net.cpp:454] out <- attention_perm
I0605 13:27:58.794832 21499 net.cpp:411] out -> out
I0605 13:27:58.794852 21499 net.cpp:150] Setting up out
I0605 13:27:58.794857 21499 net.cpp:157] Top shape: 1 1 512 900 (460800)
I0605 13:27:58.794860 21499 net.cpp:165] Memory required for data: 1472984172
I0605 13:27:58.794864 21499 layer_factory.hpp:77] Creating layer out_reshape
I0605 13:27:58.794872 21499 net.cpp:106] Creating Layer out_reshape
I0605 13:27:58.794875 21499 net.cpp:454] out_reshape <- out
I0605 13:27:58.794884 21499 net.cpp:411] out_reshape -> out_reshape
I0605 13:27:58.794906 21499 net.cpp:150] Setting up out_reshape
I0605 13:27:58.794912 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.794916 21499 net.cpp:165] Memory required for data: 1474827372
I0605 13:27:58.794921 21499 layer_factory.hpp:77] Creating layer out_reshape_scale
I0605 13:27:58.794932 21499 net.cpp:106] Creating Layer out_reshape_scale
I0605 13:27:58.794937 21499 net.cpp:454] out_reshape_scale <- out_reshape
I0605 13:27:58.794944 21499 net.cpp:411] out_reshape_scale -> out_reshape_scale
I0605 13:27:58.795008 21499 net.cpp:150] Setting up out_reshape_scale
I0605 13:27:58.795014 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.795017 21499 net.cpp:165] Memory required for data: 1476670572
I0605 13:27:58.795022 21499 layer_factory.hpp:77] Creating layer out_x
I0605 13:27:58.795030 21499 net.cpp:106] Creating Layer out_x
I0605 13:27:58.795037 21499 net.cpp:454] out_x <- out_reshape_scale
I0605 13:27:58.795043 21499 net.cpp:454] out_x <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_3
I0605 13:27:58.795049 21499 net.cpp:411] out_x -> out_x
I0605 13:27:58.795073 21499 net.cpp:150] Setting up out_x
I0605 13:27:58.795078 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.795083 21499 net.cpp:165] Memory required for data: 1478513772
I0605 13:27:58.795086 21499 layer_factory.hpp:77] Creating layer query_conv_reshape_ch
I0605 13:27:58.795092 21499 net.cpp:106] Creating Layer query_conv_reshape_ch
I0605 13:27:58.795097 21499 net.cpp:454] query_conv_reshape_ch <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_4
I0605 13:27:58.795106 21499 net.cpp:411] query_conv_reshape_ch -> query_conv_reshape_ch
I0605 13:27:58.795130 21499 net.cpp:150] Setting up query_conv_reshape_ch
I0605 13:27:58.795137 21499 net.cpp:157] Top shape: 1 512 900 1 (460800)
I0605 13:27:58.795140 21499 net.cpp:165] Memory required for data: 1480356972
I0605 13:27:58.795145 21499 layer_factory.hpp:77] Creating layer key_conv_reshape_ch
I0605 13:27:58.795152 21499 net.cpp:106] Creating Layer key_conv_reshape_ch
I0605 13:27:58.795157 21499 net.cpp:454] key_conv_reshape_ch <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_5
I0605 13:27:58.795164 21499 net.cpp:411] key_conv_reshape_ch -> key_conv_reshape_ch
I0605 13:27:58.795188 21499 net.cpp:150] Setting up key_conv_reshape_ch
I0605 13:27:58.795194 21499 net.cpp:157] Top shape: 1 512 900 1 (460800)
I0605 13:27:58.795197 21499 net.cpp:165] Memory required for data: 1482200172
I0605 13:27:58.795202 21499 layer_factory.hpp:77] Creating layer value_conv_reshape_ch
I0605 13:27:58.795207 21499 net.cpp:106] Creating Layer value_conv_reshape_ch
I0605 13:27:58.795212 21499 net.cpp:454] value_conv_reshape_ch <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_6
I0605 13:27:58.795217 21499 net.cpp:411] value_conv_reshape_ch -> value_conv_reshape_ch
I0605 13:27:58.795239 21499 net.cpp:150] Setting up value_conv_reshape_ch
I0605 13:27:58.795245 21499 net.cpp:157] Top shape: 1 512 900 1 (460800)
I0605 13:27:58.795248 21499 net.cpp:165] Memory required for data: 1484043372
I0605 13:27:58.795253 21499 layer_factory.hpp:77] Creating layer query_conv_reshape_perm_ch
I0605 13:27:58.795260 21499 net.cpp:106] Creating Layer query_conv_reshape_perm_ch
I0605 13:27:58.795265 21499 net.cpp:454] query_conv_reshape_perm_ch <- query_conv_reshape_ch
I0605 13:27:58.795272 21499 net.cpp:411] query_conv_reshape_perm_ch -> query_conv_reshape_perm_ch
I0605 13:27:58.795339 21499 net.cpp:150] Setting up query_conv_reshape_perm_ch
I0605 13:27:58.795346 21499 net.cpp:157] Top shape: 1 1 512 900 (460800)
I0605 13:27:58.795348 21499 net.cpp:165] Memory required for data: 1485886572
I0605 13:27:58.795351 21499 layer_factory.hpp:77] Creating layer key_conv_reshape_perm_ch
I0605 13:27:58.795356 21499 net.cpp:106] Creating Layer key_conv_reshape_perm_ch
I0605 13:27:58.795361 21499 net.cpp:454] key_conv_reshape_perm_ch <- key_conv_reshape_ch
I0605 13:27:58.795365 21499 net.cpp:411] key_conv_reshape_perm_ch -> key_conv_reshape_perm_ch
I0605 13:27:58.795431 21499 net.cpp:150] Setting up key_conv_reshape_perm_ch
I0605 13:27:58.795437 21499 net.cpp:157] Top shape: 1 1 900 512 (460800)
I0605 13:27:58.795440 21499 net.cpp:165] Memory required for data: 1487729772
I0605 13:27:58.795444 21499 layer_factory.hpp:77] Creating layer energy_ch
I0605 13:27:58.795449 21499 net.cpp:106] Creating Layer energy_ch
I0605 13:27:58.795454 21499 net.cpp:454] energy_ch <- query_conv_reshape_perm_ch
I0605 13:27:58.795460 21499 net.cpp:454] energy_ch <- key_conv_reshape_perm_ch
I0605 13:27:58.795469 21499 net.cpp:411] energy_ch -> energy_ch
I0605 13:27:58.795495 21499 net.cpp:150] Setting up energy_ch
I0605 13:27:58.795500 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.795502 21499 net.cpp:165] Memory required for data: 1488778348
I0605 13:27:58.795506 21499 layer_factory.hpp:77] Creating layer energy_ch_energy_ch_0_split
I0605 13:27:58.795512 21499 net.cpp:106] Creating Layer energy_ch_energy_ch_0_split
I0605 13:27:58.795517 21499 net.cpp:454] energy_ch_energy_ch_0_split <- energy_ch
I0605 13:27:58.795523 21499 net.cpp:411] energy_ch_energy_ch_0_split -> energy_ch_energy_ch_0_split_0
I0605 13:27:58.795533 21499 net.cpp:411] energy_ch_energy_ch_0_split -> energy_ch_energy_ch_0_split_1
I0605 13:27:58.795563 21499 net.cpp:150] Setting up energy_ch_energy_ch_0_split
I0605 13:27:58.795569 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.795573 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.795578 21499 net.cpp:165] Memory required for data: 1490875500
I0605 13:27:58.795583 21499 layer_factory.hpp:77] Creating layer energy_ch_pool
I0605 13:27:58.795590 21499 net.cpp:106] Creating Layer energy_ch_pool
I0605 13:27:58.795595 21499 net.cpp:454] energy_ch_pool <- energy_ch_energy_ch_0_split_0
I0605 13:27:58.795600 21499 net.cpp:411] energy_ch_pool -> energy_ch_pool
I0605 13:27:58.795632 21499 net.cpp:150] Setting up energy_ch_pool
I0605 13:27:58.795639 21499 net.cpp:157] Top shape: 1 1 512 1 (512)
I0605 13:27:58.795641 21499 net.cpp:165] Memory required for data: 1490877548
I0605 13:27:58.795644 21499 layer_factory.hpp:77] Creating layer energy_ch_max
I0605 13:27:58.795650 21499 net.cpp:106] Creating Layer energy_ch_max
I0605 13:27:58.795655 21499 net.cpp:454] energy_ch_max <- energy_ch_pool
I0605 13:27:58.795660 21499 net.cpp:411] energy_ch_max -> energy_ch_max
I0605 13:27:58.795686 21499 net.cpp:150] Setting up energy_ch_max
I0605 13:27:58.795691 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.795696 21499 net.cpp:165] Memory required for data: 1491926124
I0605 13:27:58.795699 21499 layer_factory.hpp:77] Creating layer energy_ch_minus
I0605 13:27:58.795708 21499 net.cpp:106] Creating Layer energy_ch_minus
I0605 13:27:58.795714 21499 net.cpp:454] energy_ch_minus <- energy_ch_energy_ch_0_split_1
I0605 13:27:58.795720 21499 net.cpp:411] energy_ch_minus -> energy_ch_minus
I0605 13:27:58.795742 21499 net.cpp:150] Setting up energy_ch_minus
I0605 13:27:58.795748 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.795752 21499 net.cpp:165] Memory required for data: 1492974700
I0605 13:27:58.795755 21499 layer_factory.hpp:77] Creating layer energy_new
I0605 13:27:58.795763 21499 net.cpp:106] Creating Layer energy_new
I0605 13:27:58.795769 21499 net.cpp:454] energy_new <- energy_ch_max
I0605 13:27:58.795774 21499 net.cpp:454] energy_new <- energy_ch_minus
I0605 13:27:58.795779 21499 net.cpp:411] energy_new -> energy_new
I0605 13:27:58.795800 21499 net.cpp:150] Setting up energy_new
I0605 13:27:58.795805 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.795809 21499 net.cpp:165] Memory required for data: 1494023276
I0605 13:27:58.795812 21499 layer_factory.hpp:77] Creating layer attention_ch
I0605 13:27:58.795819 21499 net.cpp:106] Creating Layer attention_ch
I0605 13:27:58.795822 21499 net.cpp:454] attention_ch <- energy_new
I0605 13:27:58.795831 21499 net.cpp:411] attention_ch -> attention_ch
I0605 13:27:58.796389 21499 net.cpp:150] Setting up attention_ch
I0605 13:27:58.796398 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.796402 21499 net.cpp:165] Memory required for data: 1495071852
I0605 13:27:58.796407 21499 layer_factory.hpp:77] Creating layer value_conv_reshape_ch_perm
I0605 13:27:58.796416 21499 net.cpp:106] Creating Layer value_conv_reshape_ch_perm
I0605 13:27:58.796422 21499 net.cpp:454] value_conv_reshape_ch_perm <- value_conv_reshape_ch
I0605 13:27:58.796430 21499 net.cpp:411] value_conv_reshape_ch_perm -> value_conv_reshape_ch_perm
I0605 13:27:58.796504 21499 net.cpp:150] Setting up value_conv_reshape_ch_perm
I0605 13:27:58.796521 21499 net.cpp:157] Top shape: 1 1 512 900 (460800)
I0605 13:27:58.796525 21499 net.cpp:165] Memory required for data: 1496915052
I0605 13:27:58.796528 21499 layer_factory.hpp:77] Creating layer attention_ch_perm
I0605 13:27:58.796536 21499 net.cpp:106] Creating Layer attention_ch_perm
I0605 13:27:58.796541 21499 net.cpp:454] attention_ch_perm <- attention_ch
I0605 13:27:58.796548 21499 net.cpp:411] attention_ch_perm -> attention_ch_perm
I0605 13:27:58.796619 21499 net.cpp:150] Setting up attention_ch_perm
I0605 13:27:58.796625 21499 net.cpp:157] Top shape: 1 1 512 512 (262144)
I0605 13:27:58.796628 21499 net.cpp:165] Memory required for data: 1497963628
I0605 13:27:58.796633 21499 layer_factory.hpp:77] Creating layer out_ch
I0605 13:27:58.796638 21499 net.cpp:106] Creating Layer out_ch
I0605 13:27:58.796644 21499 net.cpp:454] out_ch <- attention_ch_perm
I0605 13:27:58.796653 21499 net.cpp:454] out_ch <- value_conv_reshape_ch_perm
I0605 13:27:58.796659 21499 net.cpp:411] out_ch -> out_ch
I0605 13:27:58.796679 21499 net.cpp:150] Setting up out_ch
I0605 13:27:58.796685 21499 net.cpp:157] Top shape: 1 1 512 900 (460800)
I0605 13:27:58.796689 21499 net.cpp:165] Memory required for data: 1499806828
I0605 13:27:58.796691 21499 layer_factory.hpp:77] Creating layer out_ch_reshape
I0605 13:27:58.796697 21499 net.cpp:106] Creating Layer out_ch_reshape
I0605 13:27:58.796703 21499 net.cpp:454] out_ch_reshape <- out_ch
I0605 13:27:58.796712 21499 net.cpp:411] out_ch_reshape -> out_ch_reshape
I0605 13:27:58.796737 21499 net.cpp:150] Setting up out_ch_reshape
I0605 13:27:58.796746 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.796748 21499 net.cpp:165] Memory required for data: 1501650028
I0605 13:27:58.796753 21499 layer_factory.hpp:77] Creating layer out_ch_reshape_scale
I0605 13:27:58.796761 21499 net.cpp:106] Creating Layer out_ch_reshape_scale
I0605 13:27:58.796767 21499 net.cpp:454] out_ch_reshape_scale <- out_ch_reshape
I0605 13:27:58.796774 21499 net.cpp:411] out_ch_reshape_scale -> out_ch_reshape_scale
I0605 13:27:58.796839 21499 net.cpp:150] Setting up out_ch_reshape_scale
I0605 13:27:58.796845 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.796849 21499 net.cpp:165] Memory required for data: 1503493228
I0605 13:27:58.796854 21499 net.cpp:514] Sharing parameters 'scale_conv1_1' owned by layer 'out_reshape_scale', param index 0
I0605 13:27:58.796857 21499 layer_factory.hpp:77] Creating layer out_ch_x
I0605 13:27:58.796867 21499 net.cpp:106] Creating Layer out_ch_x
I0605 13:27:58.796874 21499 net.cpp:454] out_ch_x <- out_ch_reshape_scale
I0605 13:27:58.796877 21499 net.cpp:454] out_ch_x <- pool5_2_conv4_relu_pool5_2_conv4_relu_0_split_7
I0605 13:27:58.796886 21499 net.cpp:411] out_ch_x -> out_ch_x
I0605 13:27:58.796912 21499 net.cpp:150] Setting up out_ch_x
I0605 13:27:58.796917 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.796921 21499 net.cpp:165] Memory required for data: 1505336428
I0605 13:27:58.796926 21499 layer_factory.hpp:77] Creating layer out_conv_ch_x
I0605 13:27:58.796938 21499 net.cpp:106] Creating Layer out_conv_ch_x
I0605 13:27:58.796943 21499 net.cpp:454] out_conv_ch_x <- out_ch_x
I0605 13:27:58.796949 21499 net.cpp:411] out_conv_ch_x -> out_conv_ch_x
I0605 13:27:58.802793 21499 net.cpp:150] Setting up out_conv_ch_x
I0605 13:27:58.802803 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.802808 21499 net.cpp:165] Memory required for data: 1507179628
I0605 13:27:58.802814 21499 layer_factory.hpp:77] Creating layer out_conv_x
I0605 13:27:58.802825 21499 net.cpp:106] Creating Layer out_conv_x
I0605 13:27:58.802830 21499 net.cpp:454] out_conv_x <- out_x
I0605 13:27:58.802836 21499 net.cpp:411] out_conv_x -> out_conv_x
I0605 13:27:58.810763 21499 net.cpp:150] Setting up out_conv_x
I0605 13:27:58.810782 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.810786 21499 net.cpp:165] Memory required for data: 1509022828
I0605 13:27:58.810796 21499 layer_factory.hpp:77] Creating layer out_x_sum
I0605 13:27:58.810829 21499 net.cpp:106] Creating Layer out_x_sum
I0605 13:27:58.810837 21499 net.cpp:454] out_x_sum <- out_conv_x
I0605 13:27:58.810853 21499 net.cpp:454] out_x_sum <- out_conv_ch_x
I0605 13:27:58.810863 21499 net.cpp:411] out_x_sum -> out_x_sum
I0605 13:27:58.810899 21499 net.cpp:150] Setting up out_x_sum
I0605 13:27:58.810904 21499 net.cpp:157] Top shape: 1 512 30 30 (460800)
I0605 13:27:58.810909 21499 net.cpp:165] Memory required for data: 1510866028
I0605 13:27:58.810920 21499 layer_factory.hpp:77] Creating layer mask_deconv2
I0605 13:27:58.810942 21499 net.cpp:106] Creating Layer mask_deconv2
I0605 13:27:58.810946 21499 net.cpp:454] mask_deconv2 <- out_x_sum
I0605 13:27:58.810963 21499 net.cpp:411] mask_deconv2 -> mask_deconv2
I0605 13:27:58.811758 21499 net.cpp:150] Setting up mask_deconv2
I0605 13:27:58.811764 21499 net.cpp:157] Top shape: 1 256 122 122 (3810304)
I0605 13:27:58.811767 21499 net.cpp:165] Memory required for data: 1526107244
I0605 13:27:58.811784 21499 layer_factory.hpp:77] Creating layer pool5_2_conv5
I0605 13:27:58.811806 21499 net.cpp:106] Creating Layer pool5_2_conv5
I0605 13:27:58.811821 21499 net.cpp:454] pool5_2_conv5 <- mask_deconv2
I0605 13:27:58.811841 21499 net.cpp:411] pool5_2_conv5 -> pool5_2_conv5
I0605 13:27:58.837646 21499 net.cpp:150] Setting up pool5_2_conv5
I0605 13:27:58.837663 21499 net.cpp:157] Top shape: 1 512 122 122 (7620608)
I0605 13:27:58.837666 21499 net.cpp:165] Memory required for data: 1556589676
I0605 13:27:58.837699 21499 layer_factory.hpp:77] Creating layer pool5_2_conv5_relu
I0605 13:27:58.837711 21499 net.cpp:106] Creating Layer pool5_2_conv5_relu
I0605 13:27:58.837718 21499 net.cpp:454] pool5_2_conv5_relu <- pool5_2_conv5
I0605 13:27:58.837726 21499 net.cpp:411] pool5_2_conv5_relu -> pool5_2_conv5_relu
I0605 13:27:58.837901 21499 net.cpp:150] Setting up pool5_2_conv5_relu
I0605 13:27:58.837910 21499 net.cpp:157] Top shape: 1 512 122 122 (7620608)
I0605 13:27:58.837914 21499 net.cpp:165] Memory required for data: 1587072108
I0605 13:27:58.837929 21499 layer_factory.hpp:77] Creating layer pool5_2_conv6
I0605 13:27:58.837957 21499 net.cpp:106] Creating Layer pool5_2_conv6
I0605 13:27:58.837961 21499 net.cpp:454] pool5_2_conv6 <- pool5_2_conv5_relu
I0605 13:27:58.837977 21499 net.cpp:411] pool5_2_conv6 -> pool5_2_conv6
I0605 13:27:58.888025 21499 net.cpp:150] Setting up pool5_2_conv6
I0605 13:27:58.888056 21499 net.cpp:157] Top shape: 1 512 122 122 (7620608)
I0605 13:27:58.888068 21499 net.cpp:165] Memory required for data: 1617554540
I0605 13:27:58.888088 21499 layer_factory.hpp:77] Creating layer pool5_2_conv6_relu
I0605 13:27:58.888099 21499 net.cpp:106] Creating Layer pool5_2_conv6_relu
I0605 13:27:58.888108 21499 net.cpp:454] pool5_2_conv6_relu <- pool5_2_conv6
I0605 13:27:58.888118 21499 net.cpp:411] pool5_2_conv6_relu -> pool5_2_conv6_relu
I0605 13:27:58.888695 21499 net.cpp:150] Setting up pool5_2_conv6_relu
I0605 13:27:58.888703 21499 net.cpp:157] Top shape: 1 512 122 122 (7620608)
I0605 13:27:58.888706 21499 net.cpp:165] Memory required for data: 1648036972
I0605 13:27:58.888710 21499 layer_factory.hpp:77] Creating layer mask_deconv3
I0605 13:27:58.888731 21499 net.cpp:106] Creating Layer mask_deconv3
I0605 13:27:58.888737 21499 net.cpp:454] mask_deconv3 <- pool5_2_conv6_relu
I0605 13:27:58.888746 21499 net.cpp:411] mask_deconv3 -> mask_deconv3
I0605 13:27:58.889135 21499 net.cpp:150] Setting up mask_deconv3
I0605 13:27:58.889142 21499 net.cpp:157] Top shape: 1 256 244 244 (15241216)
I0605 13:27:58.889145 21499 net.cpp:165] Memory required for data: 1709001836
I0605 13:27:58.889161 21499 layer_factory.hpp:77] Creating layer mask_score
I0605 13:27:58.889186 21499 net.cpp:106] Creating Layer mask_score
I0605 13:27:58.889191 21499 net.cpp:454] mask_score <- mask_deconv3
I0605 13:27:58.889207 21499 net.cpp:411] mask_score -> mask_score
I0605 13:27:58.890317 21499 net.cpp:150] Setting up mask_score
I0605 13:27:58.890326 21499 net.cpp:157] Top shape: 1 8 244 244 (476288)
I0605 13:27:58.890331 21499 net.cpp:165] Memory required for data: 1710906988
I0605 13:27:58.890347 21499 layer_factory.hpp:77] Creating layer loss_mask
I0605 13:27:58.890369 21499 net.cpp:106] Creating Layer loss_mask
I0605 13:27:58.890377 21499 net.cpp:454] loss_mask <- mask_score
I0605 13:27:58.890381 21499 net.cpp:454] loss_mask <- mask_targets
I0605 13:27:58.890388 21499 net.cpp:411] loss_mask -> loss_mask
I0605 13:27:58.890400 21499 layer_factory.hpp:77] Creating layer loss_mask
I0605 13:27:58.891340 21499 net.cpp:150] Setting up loss_mask
I0605 13:27:58.891348 21499 net.cpp:157] Top shape: (1)
I0605 13:27:58.891352 21499 net.cpp:160]     with loss weight 3
I0605 13:27:58.891362 21499 net.cpp:165] Memory required for data: 1710906992
I0605 13:27:58.891366 21499 net.cpp:226] loss_mask needs backward computation.
I0605 13:27:58.891381 21499 net.cpp:226] mask_score needs backward computation.
I0605 13:27:58.891386 21499 net.cpp:226] mask_deconv3 needs backward computation.
I0605 13:27:58.891391 21499 net.cpp:226] pool5_2_conv6_relu needs backward computation.
I0605 13:27:58.891394 21499 net.cpp:226] pool5_2_conv6 needs backward computation.
I0605 13:27:58.891397 21499 net.cpp:226] pool5_2_conv5_relu needs backward computation.
I0605 13:27:58.891402 21499 net.cpp:226] pool5_2_conv5 needs backward computation.
I0605 13:27:58.891418 21499 net.cpp:226] mask_deconv2 needs backward computation.
I0605 13:27:58.891422 21499 net.cpp:226] out_x_sum needs backward computation.
I0605 13:27:58.891427 21499 net.cpp:226] out_conv_x needs backward computation.
I0605 13:27:58.891430 21499 net.cpp:226] out_conv_ch_x needs backward computation.
I0605 13:27:58.891434 21499 net.cpp:226] out_ch_x needs backward computation.
I0605 13:27:58.891443 21499 net.cpp:226] out_ch_reshape_scale needs backward computation.
I0605 13:27:58.891448 21499 net.cpp:226] out_ch_reshape needs backward computation.
I0605 13:27:58.891454 21499 net.cpp:226] out_ch needs backward computation.
I0605 13:27:58.891459 21499 net.cpp:226] attention_ch_perm needs backward computation.
I0605 13:27:58.891465 21499 net.cpp:226] value_conv_reshape_ch_perm needs backward computation.
I0605 13:27:58.891471 21499 net.cpp:226] attention_ch needs backward computation.
I0605 13:27:58.891476 21499 net.cpp:226] energy_new needs backward computation.
I0605 13:27:58.891480 21499 net.cpp:226] energy_ch_minus needs backward computation.
I0605 13:27:58.891485 21499 net.cpp:226] energy_ch_max needs backward computation.
I0605 13:27:58.891499 21499 net.cpp:226] energy_ch_pool needs backward computation.
I0605 13:27:58.891505 21499 net.cpp:226] energy_ch_energy_ch_0_split needs backward computation.
I0605 13:27:58.891520 21499 net.cpp:226] energy_ch needs backward computation.
I0605 13:27:58.891525 21499 net.cpp:226] key_conv_reshape_perm_ch needs backward computation.
I0605 13:27:58.891531 21499 net.cpp:226] query_conv_reshape_perm_ch needs backward computation.
I0605 13:27:58.891537 21499 net.cpp:226] value_conv_reshape_ch needs backward computation.
I0605 13:27:58.891542 21499 net.cpp:226] key_conv_reshape_ch needs backward computation.
I0605 13:27:58.891547 21499 net.cpp:226] query_conv_reshape_ch needs backward computation.
I0605 13:27:58.891551 21499 net.cpp:226] out_x needs backward computation.
I0605 13:27:58.891558 21499 net.cpp:226] out_reshape_scale needs backward computation.
I0605 13:27:58.891564 21499 net.cpp:226] out_reshape needs backward computation.
I0605 13:27:58.891568 21499 net.cpp:226] out needs backward computation.
I0605 13:27:58.891573 21499 net.cpp:226] attention_perm needs backward computation.
I0605 13:27:58.891578 21499 net.cpp:226] value_conv_reshape_perm needs backward computation.
I0605 13:27:58.891582 21499 net.cpp:226] attention needs backward computation.
I0605 13:27:58.891588 21499 net.cpp:226] energy needs backward computation.
I0605 13:27:58.891592 21499 net.cpp:226] key_conv_reshape_perm needs backward computation.
I0605 13:27:58.891598 21499 net.cpp:226] query_conv_reshape_perm needs backward computation.
I0605 13:27:58.891602 21499 net.cpp:226] value_conv_reshape needs backward computation.
I0605 13:27:58.891607 21499 net.cpp:226] key_conv_reshape needs backward computation.
I0605 13:27:58.891611 21499 net.cpp:226] query_conv_reshape needs backward computation.
I0605 13:27:58.891618 21499 net.cpp:226] value_conv needs backward computation.
I0605 13:27:58.891623 21499 net.cpp:226] key_conv needs backward computation.
I0605 13:27:58.891626 21499 net.cpp:226] query_conv needs backward computation.
I0605 13:27:58.891631 21499 net.cpp:226] pool5_2_conv4_relu_pool5_2_conv4_relu_0_split needs backward computation.
I0605 13:27:58.891638 21499 net.cpp:226] pool5_2_conv4_relu needs backward computation.
I0605 13:27:58.891644 21499 net.cpp:226] pool5_2_conv4 needs backward computation.
I0605 13:27:58.891647 21499 net.cpp:226] pool5_2_conv3_relu needs backward computation.
I0605 13:27:58.891655 21499 net.cpp:226] pool5_2_conv3 needs backward computation.
I0605 13:27:58.891659 21499 net.cpp:226] mask_deconv1 needs backward computation.
I0605 13:27:58.891664 21499 net.cpp:226] pool5_2_conv2_relu needs backward computation.
I0605 13:27:58.891669 21499 net.cpp:226] pool5_2_conv2 needs backward computation.
I0605 13:27:58.891675 21499 net.cpp:226] pool5_2_conv_relu needs backward computation.
I0605 13:27:58.891680 21499 net.cpp:226] pool5_2_conv needs backward computation.
I0605 13:27:58.891686 21499 net.cpp:226] roi_pool5_2 needs backward computation.
I0605 13:27:58.891690 21499 net.cpp:226] loss_bbox needs backward computation.
I0605 13:27:58.891696 21499 net.cpp:226] loss_cls needs backward computation.
I0605 13:27:58.891701 21499 net.cpp:226] bbox_pred needs backward computation.
I0605 13:27:58.891706 21499 net.cpp:226] cls_score needs backward computation.
I0605 13:27:58.891710 21499 net.cpp:226] fc7_relu7_0_split needs backward computation.
I0605 13:27:58.891714 21499 net.cpp:226] relu7 needs backward computation.
I0605 13:27:58.891721 21499 net.cpp:226] fc7 needs backward computation.
I0605 13:27:58.891724 21499 net.cpp:226] relu6 needs backward computation.
I0605 13:27:58.891728 21499 net.cpp:226] fc6 needs backward computation.
I0605 13:27:58.891733 21499 net.cpp:226] roi_pool5 needs backward computation.
I0605 13:27:58.891738 21499 net.cpp:226] roi-data needs backward computation.
I0605 13:27:58.891746 21499 net.cpp:226] proposal needs backward computation.
I0605 13:27:58.891753 21499 net.cpp:226] rpn_cls_prob_reshape needs backward computation.
I0605 13:27:58.891759 21499 net.cpp:226] rpn_cls_prob needs backward computation.
I0605 13:27:58.891764 21499 net.cpp:226] rpn_loss_bbox needs backward computation.
I0605 13:27:58.891772 21499 net.cpp:226] rpn_loss_cls needs backward computation.
I0605 13:27:58.891777 21499 net.cpp:226] rpn-data needs backward computation.
I0605 13:27:58.891789 21499 net.cpp:226] rpn_cls_score_reshape_rpn_cls_score_reshape_0_split needs backward computation.
I0605 13:27:58.891794 21499 net.cpp:226] rpn_cls_score_reshape needs backward computation.
I0605 13:27:58.891798 21499 net.cpp:226] rpn_bbox_pred_rpn_bbox_pred_0_split needs backward computation.
I0605 13:27:58.891803 21499 net.cpp:226] rpn_bbox_pred needs backward computation.
I0605 13:27:58.891808 21499 net.cpp:226] rpn_cls_score_rpn_cls_score_0_split needs backward computation.
I0605 13:27:58.891813 21499 net.cpp:226] rpn_cls_score needs backward computation.
I0605 13:27:58.891819 21499 net.cpp:226] rpn/output_rpn_relu/3x3_0_split needs backward computation.
I0605 13:27:58.891824 21499 net.cpp:226] rpn_relu/3x3 needs backward computation.
I0605 13:27:58.891829 21499 net.cpp:226] rpn_conv/3x3 needs backward computation.
I0605 13:27:58.891834 21499 net.cpp:226] conv5_3_relu5_3_0_split needs backward computation.
I0605 13:27:58.891839 21499 net.cpp:226] relu5_3 needs backward computation.
I0605 13:27:58.891844 21499 net.cpp:226] conv5_3 needs backward computation.
I0605 13:27:58.891849 21499 net.cpp:226] relu5_2 needs backward computation.
I0605 13:27:58.891851 21499 net.cpp:226] conv5_2 needs backward computation.
I0605 13:27:58.891856 21499 net.cpp:226] relu5_1 needs backward computation.
I0605 13:27:58.891860 21499 net.cpp:226] conv5_1 needs backward computation.
I0605 13:27:58.891865 21499 net.cpp:226] pool4 needs backward computation.
I0605 13:27:58.891871 21499 net.cpp:226] relu4_3 needs backward computation.
I0605 13:27:58.891876 21499 net.cpp:226] conv4_3 needs backward computation.
I0605 13:27:58.891882 21499 net.cpp:226] relu4_2 needs backward computation.
I0605 13:27:58.891886 21499 net.cpp:226] conv4_2 needs backward computation.
I0605 13:27:58.891891 21499 net.cpp:226] relu4_1 needs backward computation.
I0605 13:27:58.891897 21499 net.cpp:226] conv4_1 needs backward computation.
I0605 13:27:58.891901 21499 net.cpp:226] pool3 needs backward computation.
I0605 13:27:58.891907 21499 net.cpp:226] relu3_3 needs backward computation.
I0605 13:27:58.891912 21499 net.cpp:226] conv3_3 needs backward computation.
I0605 13:27:58.891916 21499 net.cpp:226] relu3_2 needs backward computation.
I0605 13:27:58.891922 21499 net.cpp:226] conv3_2 needs backward computation.
I0605 13:27:58.891927 21499 net.cpp:226] relu3_1 needs backward computation.
I0605 13:27:58.891930 21499 net.cpp:226] conv3_1 needs backward computation.
I0605 13:27:58.891935 21499 net.cpp:228] pool2 does not need backward computation.
I0605 13:27:58.891939 21499 net.cpp:228] relu2_2 does not need backward computation.
I0605 13:27:58.891944 21499 net.cpp:228] conv2_2 does not need backward computation.
I0605 13:27:58.891949 21499 net.cpp:228] relu2_1 does not need backward computation.
I0605 13:27:58.891954 21499 net.cpp:228] conv2_1 does not need backward computation.
I0605 13:27:58.891959 21499 net.cpp:228] pool1 does not need backward computation.
I0605 13:27:58.891965 21499 net.cpp:228] relu1_2 does not need backward computation.
I0605 13:27:58.891969 21499 net.cpp:228] conv1_2 does not need backward computation.
I0605 13:27:58.891974 21499 net.cpp:228] relu1_1 does not need backward computation.
I0605 13:27:58.891983 21499 net.cpp:228] conv1_1 does not need backward computation.
I0605 13:27:58.891988 21499 net.cpp:228] gt_boxes_input-data_2_split does not need backward computation.
I0605 13:27:58.891993 21499 net.cpp:228] im_info_input-data_1_split does not need backward computation.
I0605 13:27:58.891999 21499 net.cpp:228] data_input-data_0_split does not need backward computation.
I0605 13:27:58.892004 21499 net.cpp:228] input-data does not need backward computation.
I0605 13:27:58.892009 21499 net.cpp:270] This network produces output loss_bbox
I0605 13:27:58.892012 21499 net.cpp:270] This network produces output loss_cls
I0605 13:27:58.892017 21499 net.cpp:270] This network produces output loss_mask
I0605 13:27:58.892022 21499 net.cpp:270] This network produces output rois_attribute
I0605 13:27:58.892026 21499 net.cpp:270] This network produces output rpn_cls_loss
I0605 13:27:58.892032 21499 net.cpp:270] This network produces output rpn_loss_bbox
I0605 13:27:58.892110 21499 net.cpp:283] Network initialization done.
I0605 13:27:58.892305 21499 solver.cpp:60] Solver scaffolding done.
Loading pretrained model weights from data/imagenet_models/VGG16.v2.caffemodel
[libprotobuf WARNING google/protobuf/io/coded_stream.cc:505] Reading dangerously large protocol message.  If the message turns out to be larger than 2147483647 bytes, parsing will be halted for security reasons.  To increase the limit (or to disable these warnings), see CodedInputStream::SetTotalBytesLimit() in google/protobuf/io/coded_stream.h.
[libprotobuf WARNING google/protobuf/io/coded_stream.cc:78] The total number of bytes read was 553432430
I0605 13:28:08.540637 21499 net.cpp:816] Ignoring source layer pool5
I0605 13:28:08.608906 21499 net.cpp:816] Ignoring source layer drop6
I0605 13:28:08.620226 21499 net.cpp:816] Ignoring source layer drop7
I0605 13:28:08.620244 21499 net.cpp:816] Ignoring source layer fc8
I0605 13:28:08.620247 21499 net.cpp:816] Ignoring source layer prob
Solving...
[1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
(48,)
15080
[1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
(48,)
15735
I0605 13:28:10.557715 21499 solver.cpp:229] Iteration 0, loss = 9.12671
I0605 13:28:10.557744 21499 solver.cpp:245]     Train net output #0: loss_bbox = 0.244229 (* 2 = 0.488458 loss)
I0605 13:28:10.557752 21499 solver.cpp:245]     Train net output #1: loss_cls = 0.52338 (* 3 = 1.57014 loss)
I0605 13:28:10.557759 21499 solver.cpp:245]     Train net output #2: loss_mask = 2.07894 (* 3 = 6.23681 loss)
I0605 13:28:10.557860 21499 solver.cpp:245]     Train net output #3: rois_attribute = 0
I0605 13:28:10.557866 21499 solver.cpp:245]     Train net output #4: rois_attribute = 0
I0605 13:28:10.557870 21499 solver.cpp:245]     Train net output #5: rois_attribute = 0
I0605 13:28:10.557874 21499 solver.cpp:245]     Train net output #6: rois_attribute = 0
I0605 13:28:10.557880 21499 solver.cpp:245]     Train net output #7: rois_attribute = 0
I0605 13:28:10.557886 21499 solver.cpp:245]     Train net output #8: rois_attribute = 0
I0605 13:28:10.557890 21499 solver.cpp:245]     Train net output #9: rois_attribute = 0
I0605 13:28:10.557905 21499 solver.cpp:245]     Train net output #10: rois_attribute = 0
I0605 13:28:10.557910 21499 solver.cpp:245]     Train net output #11: rois_attribute = 0
I0605 13:28:10.557917 21499 solver.cpp:245]     Train net output #12: rois_attribute = 0
I0605 13:28:10.557921 21499 solver.cpp:245]     Train net output #13: rois_attribute = 0
I0605 13:28:10.557927 21499 solver.cpp:245]     Train net output #14: rois_attribute = 0
I0605 13:28:10.557934 21499 solver.cpp:245]     Train net output #15: rois_attribute = 0
I0605 13:28:10.557938 21499 solver.cpp:245]     Train net output #16: rois_attribute = 0
I0605 13:28:10.557945 21499 solver.cpp:245]     Train net output #17: rois_attribute = 0
I0605 13:28:10.557950 21499 solver.cpp:245]     Train net output #18: rois_attribute = 0
I0605 13:28:10.557955 21499 solver.cpp:245]     Train net output #19: rois_attribute = 0
I0605 13:28:10.557961 21499 solver.cpp:245]     Train net output #20: rois_attribute = 0
I0605 13:28:10.557967 21499 solver.cpp:245]     Train net output #21: rois_attribute = 0
I0605 13:28:10.557973 21499 solver.cpp:245]     Train net output #22: rois_attribute = 0
I0605 13:28:10.557981 21499 solver.cpp:245]     Train net output #23: rpn_cls_loss = 0.728647 (* 1 = 0.728647 loss)
I0605 13:28:10.557989 21499 solver.cpp:245]     Train net output #24: rpn_loss_bbox = 0.0193384 (* 1 = 0.0193384 loss)
I0605 13:28:10.557997 21499 sgd_solver.cpp:106] Iteration 0, lr = 0.001
[1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
(48,)
20639
[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
(48,)
6260
[1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
(48,)
925
[1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
(48,)
7517
